/*
 *  2014.12.02  zt
 *  kia vehicles.js 
 * 
 */

$(document).ready(function() {
   //차량
   if($(".pipLayout").length){
       pipInit();
       if($(".vehicles-onScreen").length){
          vehiclesScrollMotionInit();
       }
   }
   
   //gallery
   if($(".pip_gallery").length){
      galleryInit();
   }
   
   //스펙
   if($(".pip_spec").length){
      specInit();
   }
   
   //상용제원
    if($(".business").length){
      businessInit();
   }
   
    //review
   if($(".review").length){
      reviewInit();
   }
   
   //환경
   if($(".environment_cont").length){
      environmentInit();
   }
   
   //차량안정성 탭
   if($(".tab_contents_area").length){
      tabContentsInit();
   }
   /* S : 180919 */
   //차량
   /* ready 단계 실행은 load 실행으로 변경 합니다.
   if($(".snb_tit").length){
        snb_titAction();
   }
   */
   /* E : 180919 */
   
   //GNB 고정여부를 위한 화면 크기
   getBrowserHeight_vh();
   
   /* S : 180808 */
   // 모바일 스크롤 퍼센트 계산기
   // 특징페이지에만 적용
   if(document.location.href.indexOf("features.html")>0 ||document.location.href.indexOf("line-up.html")>0 ){
	   mobileScrollPos();
   }
   
   /* E : 180808 */
});

/* S : 180919 */
$(window).load(function() {
   //차량 로고 액션
   if($(".snb_tit").length){
        snb_titAction();
   }
});
/* E : 180919*/

var lastWindowHeight = 800, lastWindowWidth = 800;

//gnb 고정여부 기준 
var gnbStdHeight_vh=820;
var gnbFlag_vh =false;
function getBrowserHeight_vh() {
	if($(window).height()>gnbStdHeight_vh){
		gnbFlag_vh=true;
	}else{
		gnbFlag_vh=false;
	}
};


//pip초기화
var pipInit = function(){
    var k=1, persent, currentIndicatorNum = 0, indicatorMaxNum = $(".indicator_inner > ul > li").length, indicatorSpeed = 0.5, indicatorWidth = 129, indicatorInMotionEnd = false,
    pipTopArr=[], viewportWidth, isBuildTweenComplete = false;
    window.onload = function(e){ 
            loadComplete();
    };
    
    function loadComplete(){
        if($(".keyVisualWrap").length){
            keyVisualSet();
        }
        template01Set(); 
        templateEtcSet(); // 160411
        tempNewGallerySet(); // 180330
        templateSnsSet(); // SNS180830
        template02Set();  
        template03Set();
        template04Set();
        template05Set();
        template06Set();
        template07Set();
        template08Set();
        template09Set();
        template10Set();
        pipPosSet();
        indicatorInMotion();
        widthCheck(); //170914
        
    }
      
    initCss();
    initListener();
       
    snsShareSet();    
    function initCss(){
    	$(".indicator").css({"position":"fixed","right":"-250px"});
        pipPosSet(); 
        //text-shadow
        if(IE_VER < 10 && IE_VER !== false){
            if(typeof textShadowForMSIE !== undefined){
                textShadowForMSIE({ sel : '.shadowBlack', shadow : '0 0 5px  rgb(0, 0, 0)' });
                textShadowForMSIE({ sel : '.shadowWhite', shadow : '0 0 5px  rgb(255, 255, 255)' });
            }            
        }
    }
    
    function pipPosSet(){
        document.body.style.overflow = "hidden";
        viewportWidth = $(window).width();
        var viewportHeight = $(window).height();
        document.body.style.overflow = "";

        clearTimeout($.data(this, 'resizeTimer'));
        $.data(this, 'resizeTimer', setTimeout(function() {
            pipTopArr.length = 0;
            pipTopArr = [];
            var h3title = $("#content h3").closest("div[class*='pip']");
            h3title.each(function(i){
            	//indicator중 title이 없는 컴포넌트는 indicator에 포함되지 않도록 수정 20150713 J.H.KIM start
            	if($(this).find('h3').html()!=""){
	                pipTopArr.push($(this).position().top);
	            }
            	//indicator중 title이 없는 컴포넌트는 indicator에 포함되지 않도록 수정 20150713 J.H.KIM end
            });
            pipTopArr[0] = 0;

        }, 250));
    }
    
    function indicatorInMotion(){
        if (IE_VER < 9 && IE_VER !== false) {
            indicatorSpeed = 0;
            $(".indicator .indicatorTxt").each(function(i,e){
                if(currentIndicatorNum == i){
                    TweenMax.to($(this), indicatorSpeed, {width:indicatorWidth, delay:i*0.2});
                }else{
                	if(gnbFlag_vh){
             			TweenMax.to($(this), indicatorSpeed, {width:indicatorWidth, delay:i*0.2});    
             		}else{
             			/* S : 181002 */
                        //기능 정지
             			//TweenMax.to($(this), indicatorSpeed, {width:1, delay:i*0.2});    
                        /* E : 181002 */
             		}                	
                }
            });
            TweenMax.to($(".indicator"), 0, {right:10, delay:1, onComplete:function(){$(window).scroll();}}); 
            indicatorInMotionEnd = true;
        }else{
            $(window).scroll();
            TweenMax.to($(".indicator"), 0.8, {right:10, delay:1, ease:"easeOutExpo"}); 
            setTimeout(function(){ 
                $(".indicator .indicatorTxt").each(function(i,e){
                    if(currentIndicatorNum == i){
                        TweenMax.to($(this), indicatorSpeed, {width:indicatorWidth, delay:i*0.2, onComplete:indicatorTweenEnd});
                    }else{
                    	if(gnbFlag_vh){
             				TweenMax.to($(this), indicatorSpeed, {width:indicatorWidth, delay:i*0.2, onComplete:indicatorTweenEnd});    
             			}else{
             				 /* S : 181002 */
                            //기능 정지
             				//TweenMax.to($(this), indicatorSpeed, {width:1, delay:i*0.2, onComplete:indicatorTweenEnd});    
                            /* E : 181002 */   
             			}                    	
                    }
                });     
             }, 3000);  
        }
    }
    
    function indicatorTweenEnd(){
        indicatorInMotionEnd = true;    
    }

    function initListener(){
        var initLastWidth = 800,initLastHeight =800;
        $(window).resize(function() {
            if($(window).height()!=initLastHeight || $(window).width()!=initLastWidth){
                initLastHeight = $(window).height();
                initLastWidth = $(window).width();
                pipPosSet();
            }
            getBrowserHeight_vh();
        }).resize();


        $(window).scroll(pipScrollFnc);
        
        //indicator top버튼추가 02.06
        $(".indicator_inner .topBtn > a").on("click", function (e) {
            e.stopPropagation();
            e.preventDefault();
            
            bodyScroll(0, 0.01);
        });
        
        //indicator k-dic레이어 버튼추가 02.06
        var kdicDimPop = new OpenDimPop($("#kdicLayer"), $("#kdicLayer .kdicpop"), {});
        $(".indicator_inner .kdicBtn> a").on("click", function (e) {
            e.stopPropagation();
            e.preventDefault();
            kdicDimPop.open();
        });
        
        $(".indicator_inner > ul > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            //if(!$(this).parent().hasClass("on")){
                $(".indicator_inner > ul > li").removeClass("on");
                $(this).parent().addClass("on");
                var idx = $(this).parent().index();
                currentIndicatorNum = idx;
                bodyScroll(idx);
            //}
        });   
        
        $(".indicator_inner > ul > li > a").on("mouseenter", function(e){
            e.stopPropagation();
            e.preventDefault();
            $(this).addClass("mouseenter");
            if(!indicatorInMotionEnd){return;}
            TweenMax.to($(this).find(".indicatorTxt"), indicatorSpeed, {width:indicatorWidth, ease:"easeOutQuart"});
        });  
        
        $(".indicator_inner > ul > li > a").on("mouseleave", function(e){
            e.stopPropagation();
            e.preventDefault();
            $(this).removeClass("mouseenter");
            var idx = $(this).parent().index();
            if(!indicatorInMotionEnd){return;}
            if(idx == currentIndicatorNum){return;}
            if(gnbFlag_vh){
            	TweenMax.to($(this).find(".indicatorTxt"), indicatorSpeed, {width:indicatorWidth, ease:"easeOutQuart"});
            }else{
            	/* S : 181002 */
                //기능 정지
             	//TweenMax.to($(this).find(".indicatorTxt"), indicatorSpeed, {width:1, ease:"easeOutQuart"});
                /* E : 181002 */
            }
            
        });  
        
        $(".indicator_inner > ul > li > a").on("focusin", function(e){
            e.stopPropagation();
            e.preventDefault();
            $(this).addClass("mouseenter");
            if(!indicatorInMotionEnd){return;}
            TweenMax.to($(this).find(".indicatorTxt"), indicatorSpeed, {width:indicatorWidth, ease:"easeOutQuart"});
        });  
        
        $(".indicator_inner > ul > li > a").on("focusout", function(e){
            e.stopPropagation();
            e.preventDefault();
            $(this).removeClass("mouseenter");
            var idx = $(this).parent().index();
            if(!indicatorInMotionEnd){return;}
            if(idx == currentIndicatorNum){return;}
            if(gnbFlag_vh){
            	TweenMax.to($(this).find(".indicatorTxt"), indicatorSpeed, {width:indicatorWidth, ease:"easeOutQuart"});
            }else{
            	/* S : 181002 */
                //기능 정지
             	//TweenMax.to($(this).find(".indicatorTxt"), indicatorSpeed, {width:1, ease:"easeOutQuart"});
                /* E : 181002 */
            }
            
        });  
        
        
        $(".indicator a.indicator_prev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var targetIndex = currentIndicatorNum -1;
            bodyScroll(targetIndex);
        });
        
        $(".indicator a.indicator_next").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var targetIndex = currentIndicatorNum +1;
            bodyScroll(targetIndex);
        });   
        
         //youtube popup
         $("a.youtubePop").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            if($(this).find("dl").length){
                openYoutubePopup(this,"type2");    
            }else{
                openYoutubePopup(this,"type1");
            };
        }); 
        
       //layer popup
         /* S : 180330 */
         $(".imgList li > a").on("click", function(e){        	
            e.stopPropagation();
            e.preventDefault();
            if($(this).hasClass("youtubePop")){return;}
            //template07_nodesc 용 함수
            if($(this).hasClass("noDesc")){
            	var popDesc= $(this).find(".btmTextTxt .hidden").html();
            	openPipPopup(this,"type2",popDesc);
            //	
            }else if($(this).find("dl").length){
                	openPipPopup(this,"type2");    
            }else{
                	openPipPopup(this,"type1");
            };
        });
         
         $(".tempNewGallery .gallery a").on("click", function(e){        	
            e.stopPropagation();
            e.preventDefault();
            $(this).find("picture > img").attr("tabindex", -1).focus();
            openPipPopup(this,"type1");
        });
         /* E : 180330 */
         
         
    }
    
    function bodyScroll(idx, _speed){
        var speed = _speed || 500;
        var snbMarginTop = Number($(".snb_pip").css("margin-top").replace("px",""));
        var gnbHeight=$("#header").outerHeight()+$(".snb_pip").outerHeight()+snbMarginTop;       
        if(!gnbFlag_vh){
            gnbHeight=0;
        }
        $(window).off("scroll", pipScrollFnc);      
        if(viewportWidth < MOBILE_WIDTH){  
        //mobile             
            $("body,html").stop().animate({"scrollTop": pipTopArr[idx]-30}, speed, function(){
               indicatorSet(idx);           
               $(window).scroll();
            });
        }else if(viewportWidth < TABLET_WIDTH){
         //tablet  
            $("body,html").stop().animate({"scrollTop": pipTopArr[idx]-80}, speed, function(){
               indicatorSet(idx);           
               $(window).scroll();
            });
        }else{
        //pc          
            $("body,html").stop().animate({"scrollTop": pipTopArr[idx]-gnbHeight}, speed, function(){
                indicatorSet(idx);
                $(window).scroll();
            });  
        }
       
    }
        
    function pipScrollFnc(){
        if(viewportWidth < TABLET_WIDTH){
            if($(".pip_build").not(".no_motion").length){
                $(".build_car img").css({"position":"","left":""});
            }
           //return; 
        } 
        
        var scrollTop = $(window).scrollTop()+150;
        var scrollBottom = scrollTop + $(window).height();
        var currentIdx, tempHeight= 100;
        
        //wddo
        var h3title = $("#content h3").filter(function () {
            return $(this).closest('.keyVisualWrap').length === 0
        }).closest("div[class*='pip']");
        
        $(pipTopArr).each(function(i){
            if(scrollTop < pipTopArr[i]){
                currentIdx = i-1; 
                return false;
            }else {
                currentIdx = i; 
            }
        });
        
        clearTimeout($.data(this, 'scrollTimer'));
        $.data(this, 'scrollTimer', setTimeout(function() {
             indicatorSet(currentIdx);
        }, 250));
        
        if($(".pip_build").not(".no_motion").length){
           var docTop = $(document).height();
           var winHeight = $(window).height();
           var footerHeight = $("#footer").outerHeight();
           var startBuildHeight = 300;
           var currentScrollBottom = docTop - (scrollTop + winHeight) - (footerHeight + startBuildHeight);
           if(currentScrollBottom > 500){
               if(viewportWidth < TABLET_WIDTH){
                    $(".build_car img").css({"position":"relative","left":0});
                }else{
                    $(".build_car img").css({"position":"relative","left":1200});
                }
                isBuildTweenComplete = false;    
           }
           if(isBuildTweenComplete)return;
           if(currentScrollBottom < 0){
               TweenMax.to($(".build_car img"), 0.8, {left:"0px", force3D:true, ease:"easeOutQuart"});
               isBuildTweenComplete = true;    
           }
        }
    }  
    
    function indicatorSet(idx){
        $(window).off("scroll",pipScrollFnc).on("scroll",pipScrollFnc);
        if(currentIndicatorNum != idx){
            $(".indicator_inner > ul > li").removeClass("on");
            $(".indicator_inner > ul > li:eq("+idx+")").addClass("on");
            /*S :170914 */            
            $('.m_indicator .tab li:eq('+idx+')').addClass('on').siblings().removeClass('on');           
            subMenuTab();          
            /*E :170914 */
            currentIndicatorNum = idx;
        }
        if(idx < 1){
            $(".indicator a.indicator_prev").addClass("masked");
        }else{
            $(".indicator a.indicator_prev").removeClass("masked");
        }
        
        if(idx >= indicatorMaxNum-1){
            $(".indicator a.indicator_next").css("display","none");
        }else{
            $(".indicator a.indicator_next").css("display","inline-block");
        }
        if(!indicatorInMotionEnd){return;}
        $(".indicator .indicatorTxt").each(function(i,e){
            if(currentIndicatorNum == i){
                TweenMax.to($(this), indicatorSpeed, {width:indicatorWidth, ease:"easeOutQuart"});
            }else{
                if($(this).parent().hasClass("mouseenter")){return;}
                if(gnbFlag_vh){
            		TweenMax.to($(this), indicatorSpeed, {width:indicatorWidth, ease:"easeOutQuart"});    
            	}else{
            		/* S : 181002 */
                    //기능 정지
             		//TweenMax.to($(this), indicatorSpeed, {width:1, ease:"easeOutQuart"});    
                    /* E : 181002 */
           		}
                
            }
        });
    }
    /* S : 170914 (모바일인디케이터) */
    function widthCheck() {
     var wid=0;
     $('.m_indicator .tab ul li').each(function(){
        wid += $(this).outerWidth();            
     });
     $('.m_indicator .tab ul').css('minWidth',wid + 20); //170922
     //console.log(wid);    
    }

    function subMenuTab(){
        var obj, poLeft;    
        obj = $(".m_indicator .tab");           
        poLeft = $(obj).find(".on").offset().left;
        $(obj).animate({scrollLeft: poLeft}, 500);              
    }
   

    $('.m_indicator .tab li').on("click", function(e){
        e.preventDefault();
        $('.m_indicator .tab li').removeClass('on');
        $(this).addClass('on');
       // subMenuTab();
        var idx = $(this).index();
       // console.log("idx:"+idx);
        bodyScroll(idx); 
    });   
    /* E : 170914 */
};

//keyvisual
var keyVisualSet = function(){
    var lastKeyWindowHeight = 800, lastKeyWindowWidth = 800;
    if($(".coldtopContents").length){
        //냉동탑차
        var keyVisualNum = 0, keyVisualMaxNum =  $(".keyVisualWrap .paging ul > li").length;
        $(".topView ul.slider").css("width",999999);
        
        function carPosSet(idx,duration){
            $(".keyVisualWrap .paging ul > li").removeClass("on");
            $(".keyVisualWrap .paging ul > li").eq(idx).addClass("on");
            var slideLiWidth = $(".topView ul.slider > li").width();
            TweenMax.to($(".topView ul.slider"), duration, {marginLeft: slideLiWidth *-idx,  ease:"easeOutExpo"});
            keyVisualNum = idx;
        }
        
        function coldTopKeyVisualResize(){
            document.body.style.overflow = "hidden";
            var viewportWidth = $(window).width();
            document.body.style.overflow = "";
            if (IE_VER < 9 && IE_VER !== false) {
                   $(".topView ul.slider > li").css("width",940);
            } else {
                 if (viewportWidth <= TABLET_WIDTH) {
                    var liWidth = viewportWidth - 30;
                    $(".topView ul.slider > li").css("width",liWidth);
                    $(".topView ul.slider").css({"margin-left":liWidth * -keyVisualNum});
                    $(".coldtopContents .keyVisualWrap").css("height","");
//                    if(viewportWidth <= MOBILE_WIDTH){
//                        var h = $(".topView ul.slider").height() + 150;
//                        $(".coldtopContents .keyVisualWrap").css("height",h);
//                    }
                 }else{
                    $(".topView ul.slider > li").css("width",940);
                    $(".coldtopContents .keyVisualWrap").css("height","");  
                    $(".topView ul.slider").css({"margin-left":940 * -keyVisualNum});
                 }
            }
        }
        
        $(window).resize(function() {
            if($(window).height()!=lastKeyWindowHeight || $(window).width()!=lastKeyWindowWidth){
                lastKeyWindowHeight = $(window).height();
                lastKeyWindowWidth = $(window).width();
                coldTopKeyVisualResize();
            }
            getBrowserHeight_vh();
        }).resize();
        
        $(".keyVisualWrap button.prev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = keyVisualNum - 1;
            if (idx < 0){idx = 0}
            carPosSet(idx,0.5);
        });   
        
        $(".keyVisualWrap button.next").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = keyVisualNum + 1;
            if (idx > keyVisualMaxNum - 1) {idx = keyVisualMaxNum - 1;}
            carPosSet(idx, 0.5); 

        });   
        
         $(".keyVisualWrap .paging ul > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = $(this).parent().index();
            carPosSet(idx,0.5);
        });   
        
        var coldTopVisualSwipe = new onSwipeFnc(".keyVisualWrap .slider");
        coldTopVisualSwipe.moveEnd = function(evt, dir, phase, swipetype, distance) {
            if (phase == "end") {
                if (dir == "right") {
                    var idx = keyVisualNum - 1;
                    if (idx < 0){idx = 0;}
                    $(".keyVisualWrap .paging > ul > li:eq(" + idx + ") > a").trigger("click");
                } else if (dir == "left") {
                    var idx = keyVisualNum + 1;
                    if (idx > keyVisualMaxNum - 1){idx = keyVisualMaxNum - 1;}
                    $(".keyVisualWrap .paging > ul > li:eq(" + idx + ") > a").trigger("click");
                }
            }
        }; 
      
        
    }else{
        //일반차량
        var keyVisualNum = 0, keyVisualMaxNum =  $(".keyVisualInner > .paging ul > li").length, keyvisualInterval, keyvisualEnter = false, interValDelay = 6000;
        
        function keyVisualResize(){
            document.body.style.overflow = "hidden";
            var viewportWidth = $(window).width();
            document.body.style.overflow = "";
            if (IE_VER < 9 && IE_VER !== false) {
                   if(keyvisualInterval){
                       clearInterval(keyvisualInterval);
                   }
            } else {
                if (viewportWidth < MOBILE_WIDTH) {
                    if(keyvisualInterval){
                           clearInterval(keyvisualInterval);
                           keyVisualIntervarlFnc();
                    }else{
                        keyVisualIntervarlFnc();
                    }
                }
            }
        } 
        
        function keyVisualClick(idx){
            var wWidth = $(window).width();
            var use3D = false;
            if(wWidth <= MOBILE_WIDTH){
                use3D = true;
            }
            $(".keyVisual01, .keyVisual02, .keyVisual03").css({"z-index":0}).hide();
            $(".keyVisualInner > div").eq(keyVisualNum).css({"z-index":1}).hide();
            $(".keyVisualInner > div").eq(idx).css({"z-index":2}).show();
            TweenMax.to($(".keyVisualInner > div").eq(idx), 0, {x:"100%", force3D:use3D});
            if(keyVisualNum == keyVisualMaxNum-1 && idx ==0){
                TweenMax.fromTo($(".keyVisualInner > div").eq(idx), 0.8, {x:"100%"}, {x:"0%", force3D:use3D, ease:"easeOutQuart"});
            }else if(keyVisualNum == 0 && idx == keyVisualMaxNum-1){
                TweenMax.fromTo($(".keyVisualInner > div").eq(idx), 0.8, {x:"-100%"}, {x:"0%", force3D:use3D, ease:"easeOutQuart"});
            }else{
                if(idx > keyVisualNum){
                    TweenMax.fromTo($(".keyVisualInner > div").eq(idx), 0.8, {x:"100%"}, {x:"0%", force3D:use3D, ease:"easeOutQuart"});
                }else{
                    TweenMax.fromTo($(".keyVisualInner > div").eq(idx), 0.8, {x:"-100%"}, {x:"0%", force3D:use3D, ease:"easeOutQuart"});
                }
            }
            
            keyVisualNum = idx;
            keyVisualIntervarlFnc();
        }
        
        //모바일일때 키비주얼 자동롤링
        function keyVisualIntervarlFnc(){
             if(keyvisualInterval){
               clearInterval(keyvisualInterval);
             }
             if(keyVisualMaxNum < 2 || keyvisualEnter == true || $(window).width() > MOBILE_WIDTH){return;}
             keyvisualInterval = setInterval(function(){
                  keyVisualNum++;
                  if(keyVisualNum > keyVisualMaxNum-1) keyVisualNum = 0;
                  $(".keyVisualInner .paging > ul > li:eq("+ keyVisualNum +") > a").trigger("click");    
             }, interValDelay);
        }
        
        $(window).resize(function() {
            if($(window).height()!=lastKeyWindowHeight || $(window).width()!=lastKeyWindowWidth){
                lastKeyWindowHeight = $(window).height();
                lastKeyWindowWidth = $(window).width();
                keyVisualResize();
            }
            getBrowserHeight_vh();
        }).resize();
        
        $(".keyVisualInner .keyVisual01").css({"overflow":"hidden"});
        $(".keyVisualInner .keyVisual02").css({"overflow":"hidden"});
        $(".keyVisualInner .keyVisual03").css({"overflow":"hidden"});
                  
        $(".keyVisualInner .paging ul > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            if(!$(this).parent().hasClass("on")){
                $(".keyVisualWrap .paging ul > li").removeClass("on");
                $(this).parent().addClass("on");
                var idx = $(this).parent().index();
                keyVisualClick(idx);
            }
        });   
        
        $(".keyVisualWrap").on("touchstart", function(e){
            if (keyvisualInterval) {
                clearInterval(keyvisualInterval);
            }
        });   
         
       $(".keyVisualWrap").on("touchend", function(e){
            keyVisualIntervarlFnc();
        });   
         
       $(".keyVisualWrap").on("mouseenter", function(e){
            e.stopPropagation();
            e.preventDefault();
            keyvisualEnter  = true;
            if (keyvisualInterval) {
                clearInterval(keyvisualInterval);
            }
        });   
         
      $(".keyVisualWrap").on("mouseleave", function(e){
            e.stopPropagation();
            e.preventDefault();
            keyvisualEnter  = false;       
            keyVisualIntervarlFnc();
        });   
         
       $(".keyBtnLeft > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var targetIdx = $(this).parent().parent().index()-1;
            if(targetIdx < 0) targetIdx = keyVisualMaxNum-1;
            $(".keyVisualInner .paging ul > li:eq("+targetIdx+") > a").trigger("click");
        });   
        
       $(".keyBtnRight > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var targetIdx = $(this).parent().parent().index()+1;
            if(targetIdx > keyVisualMaxNum-1) targetIdx = 0;
            $(".keyVisualInner .paging ul > li:eq("+targetIdx+") > a").trigger("click");
       });        
        
        var locationHash = window.location.hash
        if(locationHash == "#360vr"){
            keyVisualNum = $(".keyVisual02").index();
            $(".keyVisualInner .paging ul > li:eq("+keyVisualNum+") > a").trigger("click");
        }else if(locationHash == "#360vr-exterior"){
            keyVisualNum = $(".keyVisual02").index();
            $(".keyVisualInner .paging ul > li:eq("+keyVisualNum+") > a").trigger("click");
            $("ul.view_inout > li:eq(0) > a").trigger("click");
        }else if(locationHash == "#360vr-interior"){
            keyVisualNum = $(".keyVisual02").index();
            $(".keyVisualInner .paging ul > li:eq("+keyVisualNum+") > a").trigger("click");
            $("ul.view_inout > li:eq(1) > a").trigger("click");
        }else if(locationHash == "#video"){
            keyVisualNum = $(".keyVisual03").index();
            $(".keyVisualInner .paging ul > li:eq("+keyVisualNum+") > a").trigger("click");
        }
    }
    
    //차량정보
    var carInfoNum = 0, carInfoMaxNum = $(".carInfor .dots > ul > li").length;
    var carInfoSwipe = new onSwipeFnc(".keyVisualWrap .carInfor");
     carInfoSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
         if(phase == "end"){
              if(dir == "right"){
                  var idx = carInfoNum-1;
                  if(idx < 0) idx = carInfoMaxNum-1;
                  $(".carInfor .dots > ul > li:eq("+ idx +") > a").trigger("click");
              }else if(dir == "left"){
                  var idx = carInfoNum+1;
                  if(idx > carInfoMaxNum-1) idx = 0;
                  $(".carInfor .dots > ul > li:eq("+ idx +") > a").trigger("click");
              }
          }        
      };
      
    $(".carInfor .dots > ul > li > a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        $(".carInfor .dots > ul > li").removeClass("on");
        $(this).parent().addClass("on");
        var idx = $(this).parent().index();
        carInfoClick(idx);
    });
     
    function carInfoClick(idx){
        $(".carInforInner > ul > li").removeClass("on");
        $(".carInforInner > ul > li").eq(idx).addClass("on");
        carInfoNum = idx;
    } 
};

function snsShareSet(){
    var tempLastWidth = 800,tempLastHeight =800;
    $(window).resize(function() {
        if($(window).height()!=tempLastHeight || $(window).width()!=tempLastWidth){
            tempLastHeight = $(window).height();
            tempLastWidth = $(window).width();
            document.body.style.overflow = "hidden";
            var viewportWidth = $(window).width();
            document.body.style.overflow = "";
            
            if (IE_VER < 9 && IE_VER !== false) {
                $(".con_share").css("width","");
            } else {
               if (viewportWidth <= MOBILE_WIDTH) {
                   $(".con_share").each(function(i,e){
                       shareMaxNum = $(this).find("ul > li").length;
                       if(shareMaxNum > 3){
                            $(this).css("width",154);
                        }else{
                            var sharWidth = shareMaxNum * 51;
                            $(this).css("width",sharWidth);
                        }
                   });
               }else {
                   $(".con_share").css("width","");
               }
            }
        }
        getBrowserHeight_vh();
    }).resize();
    
    $(".con_share").each(function(i,e){
        var shareIdx = 0, shareMaxNum = $(this).find("ul > li").length, shareLiWidth = $(this).find("ul > li").width();    
        if(shareMaxNum > 3){
            $(this).find("a.mSnsPrev").show();
            $(this).find("a.mSnsNext").show();
        }else{
            $(this).find("a.mSnsPrev").hide();
            $(this).find("a.mSnsNext").hide();
        }
        
        $(this).find("a.mSnsPrev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            shareIdx = shareIdx-1;
            if(shareIdx < 0){shareIdx = 0}
            TweenMax.to($(this).siblings("ul"), 0.8, {marginLeft: shareLiWidth * -shareIdx, ease:"easeOutQuart"});
        });
        
         $(this).find("a.mSnsNext").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            shareIdx = shareIdx+1;
            if(shareIdx > shareMaxNum-1){shareIdx = shareMaxNum-1}
            TweenMax.to($(this).siblings("ul"), 0.8, {marginLeft: shareLiWidth * -shareIdx,  ease:"easeOutQuart"});
        });
    });
}

//차량 템플릿    
var template01Set = function(){
    $(".temp01").each(function(i,e){
        mainSwipeTemplate($(this));
    });
};

/* S : 160411 */
var templateEtcSet = function(){
    $(".temp360vr").each(function(i,e){
        var tempLastWidth = 800,tempLastHeight =800, self= this;
        $(window).resize(function() {
            if($(window).height()!=tempLastHeight || $(window).width()!=tempLastWidth){
                tempLastHeight = $(window).height();
                tempLastWidth = $(window).width();
                tempEtcResizeFnc();
            }
            getBrowserHeight_vh();
        }).resize();
        
        
        
        function tempEtcResizeFnc() {
            document.body.style.overflow = "hidden";
            var viewportWidth = $(window).width();
            var viewportHeight = $(window).height();
            document.body.style.overflow = "";
            
            $(self).css({"height" : viewportHeight});
            $(self).find(".mainInner").css({"height" : viewportHeight});

            if (IE_VER < 9 && IE_VER !== false) {
                $(self).css({"height" : viewportHeight});
                $(self).find(".mainInner").css({"height" : viewportHeight});
            } else {
                if (viewportWidth < TABLET_WIDTH) {
                 if (viewportWidth < MOBILE_WIDTH){
                    $(self).css({"height" : ""});
                    $(self).find(".mainInner").css({"height" : ""});
                 }else{
                    $(self).css({"height" : ""});
                    $(self).find(".mainInner").css({"height" : ""});
                 }
               }else {
                    $(self).css({"height" : ""});
                    $(self).find(".mainInner").css({"height" : ""});
               }
            }


        }
    });
};
/* E : 160411 */

/* S : 180330 */
var tempNewGallerySet = function(){
    $(".tempNewGallery").each(function(i,e){
        var tempLastWidth = 800,tempLastHeight =800, self= this;
        $(window).resize(function() {
            if($(window).height()!=tempLastHeight || $(window).width()!=tempLastWidth){
                tempLastHeight = $(window).height();
                tempLastWidth = $(window).width();
                tempNewGalleryFnc();
            }
            getBrowserHeight_vh();
        }).resize();
        
        
        
        function tempNewGalleryFnc() {
            document.body.style.overflow = "hidden";
            var viewportWidth = $(window).width();
            var viewportHeight = $(window).height();
            document.body.style.overflow = "";
            console.log(IE_VER);
            $(self).css({"height" : viewportHeight});
            $(self).find(".mainInner").css({"height" : viewportHeight});

            if (IE_VER < 9 && IE_VER !== false) {
                $(self).css({"height" : viewportHeight});
                $(self).find(".mainInner").css({"height" : viewportHeight});
            } else {
                if (viewportWidth < TABLET_WIDTH) {
                 if (viewportWidth < MOBILE_WIDTH){
                    $(self).css({"height" : ""});
                    $(self).find(".mainInner").css({"height" : ""});
                 }else{
                    $(self).css({"height" : ""});
                    $(self).find(".mainInner").css({"height" : ""});
                 }
               }else {
                    $(self).css({"height" : ""});
                    $(self).find(".mainInner").css({"height" : ""});
               }
            }
        }
    });
};
/* E : 180330 */

/* S : SNS180830 */
var templateSnsSet = function(){
    $(".tempNewSns.itm1").each(function(i,e){
        var tempLastWidth = 800,tempLastHeight =800, self= this;
        $(window).resize(function() {
            if($(window).height()!=tempLastHeight || $(window).width()!=tempLastWidth){
                tempLastHeight = $(window).height();
                tempLastWidth = $(window).width();
                tempSnsOneFnc();
            }
            getBrowserHeight_vh();
        }).resize();
        
        
        
        /* S : SNS181015 */
        function tempSnsOneFnc() {
          document.body.style.overflow = "hidden";
          var viewportWidth = $(window).width();
          var viewportHeight = $(window).height();
          document.body.style.overflow = "";
          var snbMarginTop = Number($(".snb_pip").css("margin-top").replace("px",""));
          var gnbHeight=$("#header").outerHeight()+$(".snb_pip").outerHeight()+snbMarginTop;
          if(!gnbFlag_vh){
            gnbHeight=0;
          }
          if (IE_VER < 9 && IE_VER !== false) {
            resizeImg($(self).find(".list ul li img"), 1024, 0, innerHeight);
            var imgHeight = $(self).find(".list ul li img").height();
            var innerHeight = viewportHeight-gnbHeight;
            if(innerHeight > imgHeight){
                innerHeight = imgHeight;
            }
            $(self).find(".list ul li .itm").css({"height":innerHeight});
            /*
            $(self).find(".bgArea").css("height", innerHeight);
            $(self).find(".bgInner").css("height", innerHeight);
            $(self).find(".mainInner").css({"height" : innerHeight});
            */
          } else {


            if (viewportWidth <= TABLET_WIDTH) {
              if (viewportWidth <= MOBILE_WIDTH) {
                twSpeed = 0;
                $(self).find(".list ul li .itm").css({"height":""});
                $(self).find(".list ul li img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
                
              }else{
                twSpeed = 0.7;
                $(self).find(".list ul li .itm").css({"height":""});
                $(self).find(".list ul li img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
              }
            } else {
              twSpeed = 0.7;
              resizeImg($(self).find(".list ul li img"), 0, 0, innerHeight);
              var imgHeight = $(self).find(".list ul li img").height();
              var innerHeight = viewportHeight-gnbHeight;

              if(innerHeight > imgHeight){
                innerHeight = imgHeight;
              }
              $(self).find(".list ul li .itm").css({"height":innerHeight});
              /*
              $(self).find(".bgArea").css("height", innerHeight);
              $(self).find(".bgInner").css("height", innerHeight);
              $(self).find(".mainInner").css({"height" : innerHeight});
              */
            }


          }
        }
        /* S : SNS181015 */
    });
};
/* E : SNS180830 */

var template02Set = function(){
   $(".temp02").each(function(i,e){
         swipeTemplate($(this));
    });
};

var template03Set = function(){
    $(".temp03").each(function(i,e){
         swipeTemplate($(this));
    });
};

var template04Set = function(){
    $(".temp04").each(function(i,e){
         swipeTemplate($(this));
    });
};

var template05Set = function(){
    $(".temp05").each(function(i,e){
         swipeTemplate($(this));
    });
};

var template06Set = function(){
    $(".temp06").each(function(i,e){
         swipeTemplate($(this));
    });
};

var template07Set = function(){
    $(".temp07").each(function(i,e){
         swipeTemplate($(this));
    });
};

var template08Set = function(){
    $(".temp08").each(function(i,e){
         swipeTemplate2($(this));
    });
};

var template09Set = function(){
    $(".temp09").each(function(i,e){
        var tempLastWidth = 800,tempLastHeight =800, self= this;
        $(window).resize(function() {
            if($(window).height()!=tempLastHeight || $(window).width()!=tempLastWidth){
                tempLastHeight = $(window).height();
                tempLastWidth = $(window).width();
                temp09ResizeFnc();
            }
            getBrowserHeight_vh();
        }).resize();
        
        function temp09ResizeFnc() {
            document.body.style.overflow = "hidden";
            var viewportWidth = $(window).width();
            var viewportHeight = $(window).height();
            document.body.style.overflow = "";
            var snbMarginTop = Number($(".snb_pip").css("margin-top").replace("px",""));
            var gnbHeight=$("#header").outerHeight()+$(".snb_pip").outerHeight()+snbMarginTop;
            if(!gnbFlag_vh){
  				gnbHeight=0;
			}
            if (IE_VER < 9 && IE_VER !== false) {
                    resizeImg($(self).find(".bgInner img"), 1024, 0, innerHeight);
                    var imgHeight = $(self).find(".bgInner img").height();
                    var innerHeight = viewportHeight-gnbHeight;
                    if(innerHeight > imgHeight){
                        innerHeight = imgHeight;
                    }
                    $(self).find(".bgArea").css("height", innerHeight);
                    $(self).find(".bgInner").css("height", innerHeight);
                    $(self).find(".mainInner").css({"height" : innerHeight});
            } else {
                if (viewportWidth < TABLET_WIDTH) {
                 if (viewportWidth < MOBILE_WIDTH){
                        $(self).find(".bgArea").css("height", "");
                        $(self).find(".bgInner").css("height", "");
                        $(self).find(".bgInner img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
                        $(self).find(".mainInner").css({"height" : ""});
                 }else{
                     $(self).find(".bgArea").css("height", "");
                        $(self).find(".bgInner").css("height", "");
                        $(self).find(".bgInner img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
                        
                        bgHeight = $(self).find(".bgInner").height();
                        wrapHeight = $(self).find(".screenBox:eq(0) img").height();
                        
                        $(self).find(".bgArea").css("height", wrapHeight);
                        $(self).find(".mainInner").css({"height" : wrapHeight});     
                 }
               }else {
                resizeImg($(self).find(".bgInner img"), 0, 0, innerHeight);
                   var imgHeight = $(self).find(".bgInner img").height();
                   var innerHeight = viewportHeight-gnbHeight;
                   
                   if(innerHeight > imgHeight){
                    innerHeight = imgHeight;
                   }
                   $(self).find(".bgArea").css("height", innerHeight);
                   $(self).find(".bgInner").css("height", innerHeight);
                   $(self).find(".mainInner").css({"height" : innerHeight});
               }
            }
        }
    });
};

var template10Set = function(){
    $(".temp10").each(function(i,e){
         var tempLastWidth = 800,tempLastHeight =800, self= this;
        $(window).resize(function() {
            if($(window).height()!=tempLastHeight || $(window).width()!=tempLastWidth){
                tempLastHeight = $(window).height();
                tempLastWidth = $(window).width();
                temp10ResizeFnc();
            }
            getBrowserHeight_vh();
        }).resize();
        
        function temp10ResizeFnc() {
            document.body.style.overflow = "hidden";
            var viewportWidth = $(window).width();
            var viewportHeight = $(window).height();
            document.body.style.overflow = "";
            var snbMarginTop = Number($(".snb_pip").css("margin-top").replace("px",""));
            var gnbHeight=$("#header").outerHeight()+$(".snb_pip").outerHeight()+snbMarginTop;
            if(!gnbFlag_vh){
  				gnbHeight=0;
			}            
            if (IE_VER < 9 && IE_VER !== false) {
                    resizeImg($(self).find(".bgInner img"), 1024, 0, innerHeight);
                    var imgHeight = $(self).find(".bgInner img").height();
                    var innerHeight = viewportHeight-gnbHeight;
                    if(innerHeight > imgHeight){
                        innerHeight = imgHeight;
                    }
                    $(self).find(".bgArea").css("height", innerHeight);
                    $(self).find(".bgInner").css("height", innerHeight);
                    $(self).find(".mainInner").css({"height" : innerHeight});
            } else {
                if (viewportWidth < TABLET_WIDTH) {
                     if (viewportWidth < MOBILE_WIDTH){
                        $(self).find(".bgArea").css("height", "");
                        $(self).find(".bgInner").css("height", "");
                        $(self).find(".bgInner img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
                        $(self).find(".mainInner").css({"height" : ""});
                     }else{
                         $(self).find(".bgArea").css("height", "");
                        $(self).find(".bgInner").css("height", "");
                        $(self).find(".bgInner img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
                         
                         bgHeight = $(self).find(".bgInner").height();
                         wrapHeight = $(self).find(".screenBox:eq(0) img").height();
                         
                         $(self).find(".bgArea").css("height", wrapHeight);
                         $(self).find(".mainInner").css({"height" : wrapHeight});    
                     }
                }else {
                    resizeImg($(self).find(".bgInner img"), 0, 0, innerHeight);
                    var imgHeight = $(self).find(".bgInner img").height();
                    var innerHeight = viewportHeight-gnbHeight;
                    
                    if(innerHeight > imgHeight){
                        innerHeight = imgHeight;
                    }
                    $(self).find(".bgArea").css("height", innerHeight);
                    $(self).find(".bgInner").css("height", innerHeight);
                    $(self).find(".mainInner").css({"height" : innerHeight});
                }
            }
        }
    });
};

//차량 temp01
var mainSwipeTemplate = function(target) {
    var templateNum = 0, templatePrevNum = 0, templateMaxNum = target.find(".screenPaging > ul > li").length, tweening = false, viewportWidth, twSpeed = 0.7;
    var wrapHeight = target.find(".mainInner").height();
    var bgHeight = target.find(".bgInner").height();
    var mainLastWidth = 800,mainLastHeight =800 ;
    $(window).resize(function() {
        if($(window).height()!=mainLastHeight || $(window).width()!=mainLastWidth){
            mainLastWidth = $(window).width();
            mainLastHeight = $(window).height();
            pipTemplateResizeFnc();
        }
        getBrowserHeight_vh();
    }).resize();
    
    /* S : 180808 */    
    target.find(".pipBtnLeft").css({"position" : "absolute", "height":bgHeight, "top":0, "left":0}).addClass("off");
    target.find(".pipBtnRight").css({"position" : "absolute", "height":bgHeight, "top":0, "right":0});

    target.find(".mainInner").css({"position" : "relative","overflow" : "hidden"});
    target.find(".screenBox").css({"background-color" : "#fff"});
    target.find(".screenBox").each(function(i, e) {
        if (i != 0) {
            $(this).css({"position" : "absolute"});
        } else {
            $(this).css({"position" : "absolute","display" : "block","z-index" : 2});
        }
    });
    target.append("<div class='screenPagingTxt' style='height:" + bgHeight + "px'>" + "<p><span><span>1</span>/" + templateMaxNum +"</span></p></div>")

    
    var templateMainSwipe = new onSwipeFnc(target.find(".mainInner"));
    templateMainSwipe.moveEnd = function(evt, dir, phase, swipetype, distance) {
        if (phase == "end") {
            if (dir == "right") {
                //console.log("right");
                var idx = templateNum - 1;
                if (idx < 0){
                    //idx = templateMaxNum-1;  
                    //alert("처음 입니다.");
                }else{
                    target.find(".screenPaging ul > li:eq(" + idx + ") > a").trigger("click");    
                }
                
            } else if (dir == "left") {
                //console.log("right");
                var idx = templateNum + 1;
                if (idx > templateMaxNum-1){
                    //idx = 0;
                    //alert("마지막 입니다.");
                }else{
                    target.find(".screenPaging ul > li:eq(" + idx + ") > a").trigger("click");
                } 
                
            }
        }
    };

    target.find(".pipBtnLeft a.pip_prev").on("click", function(e) {
        e.stopPropagation();
        e.preventDefault();
        var idx = templateNum - 1;
        if (idx < 0){
            //idx = templateMaxNum-1;
            //alert("처음 입니다.");
        }else{
            target.find(".screenPaging ul > li:eq(" + idx + ") > a").trigger("click");
        }
        
    });
    
    target.find(".pipBtnRight a.pip_next").on("click", function(e) {
        e.stopPropagation();
        e.preventDefault();
        var idx = templateNum + 1;
        if (idx > templateMaxNum-1) {
            //idx = 0;
            //alert("마지막 입니다.");
            //$(this).hide();
        }else{
            //$(this).show();
            target.find(".screenPaging ul > li:eq(" + idx + ") > a").trigger("click");
        }
        
    });
    
    target.find(".screenPaging > ul > li > a").on("click", function(e) {
        e.stopPropagation();
        e.preventDefault();
        if (!$(this).parent().hasClass("on")) {
            target.find(".screenPaging > ul > li").removeClass("on");
            target.find(".screenPaging > ul > li > a").each(function(i) {
                var imgSrc = $(this).find("img").attr("src").replace("_on.png", "_off.png");
                $(this).find("img").attr("src", imgSrc);
            });
            //console.log(templateMaxNum -1, $(this).parent().index());
            if($(this).parent().index() == 0){
                target.find(".pipBtnRight").removeClass("off");
                target.find(".pipBtnLeft").addClass("off");
            }else if(templateMaxNum -1 == $(this).parent().index()){
                target.find(".pipBtnLeft").removeClass("off");
                target.find(".pipBtnRight").addClass("off");
            }else{
                target.find(".pipBtnLeft").removeClass("off");
                target.find(".pipBtnRight").removeClass("off");
            }

            target.find(".screenPagingTxt").html("<p><span><span>"+ ($(this).parent().index()+1) + "</span>/" + (templateMaxNum) + "</span></p>");

            $(this).parent().addClass("on");
            var imgSrc = $(this).find("img").attr("src").replace("_off.png", "_on.png");
            $(this).find("img").attr("src", imgSrc);
            var idx = $(this).parent().index();
            mainInnerClick(idx);
        }
    });
    /* E : 180808 */
    
    //눈 이미지 초기화
    target.find(".screenPaging > ul > li > a").each(function(i) {
        if(i==0){
            var imgSrc = $(this).find("img").attr("src").replace("_off.png", "_on.png");
        }else{
            var imgSrc = $(this).find("img").attr("src").replace("_on.png", "_off.png");
        }
        $(this).find("img").attr("src", imgSrc);
    });
    
    var isFirstScrollView = true;
    $(window).scroll(function(screvent) {
        //return;
        if($(window).width() < TABLET_WIDTH){
            $(document).off('mousewheel',mouseWheel);
            return;
        }
        
        var scrollTop = $(window).scrollTop();
        var scrollBottom = scrollTop + $(window).height();
        var targetTop = target.position().top;
        var targetBottom = targetTop + target.find(".mainInner").outerHeight();
        var targetViewPos = parseInt(scrollTop - targetTop);        
        var snbMarginTop = Number($(".snb_pip").css("margin-top").replace("px",""));
        var gnbHeight=$("#header").outerHeight()+$(".snb_pip").outerHeight()+snbMarginTop;
        
        //console.log("targetViewPos",targetViewPos);
        if (targetViewPos >= -135 && targetViewPos <= 135) { 
        	      	
           if(isFirstScrollView){
               if($("html:not(:animated),body:not(:animated)").length){                  
            	   var tmpTop=0;
            	   if(gnbFlag_vh){
            		   tmpTop=scrollTop-targetViewPos + 2-gnbHeight;            		  
            	   }else{
            		   tmpTop=scrollTop-targetViewPos + 2;            		            		   
            	   }     
            	   $(window).scrollTop(tmpTop);
               }
                //$(window).scrollTop(scrollTop-targetViewPos + 2);                  
                isFirstScrollView = false;  
           }
           $(document).on('mousewheel', mouseWheel);
        } else {        	
            isFirstScrollView = true;
            $(document).off('mousewheel',mouseWheel);
        }
    });

    function mouseWheel(event, delta, deltaX, deltaY){
    		
            event.stopPropagation();
            event.preventDefault();
            if($(window).width() < TABLET_WIDTH ){
                $(document).off('mousewheel',mouseWheel);
                return;
            } 
            if (tweening) {
                return;
            }
            var delta;
            if (event.wheelDelta) {
                delta = event.wheelDelta;
            } else {
                delta = delta;
            }
            if (delta < 0) {
                delta = 1;
            } else {
                delta = -1;
            }

            templatePrevNum = templateNum;
            if (delta < 0) {
                templateNum = templateNum - 1;
                if (templateNum >= 0) {                	
                    target.find(".screenPaging ul > li:eq(" + templateNum + ") > a").trigger("click");
                } else {                	
                    templateNum = 0;
                    $(document).off('mousewheel',mouseWheel);
                }
            } else {
                templateNum = templateNum + 1;
                if (templateNum < templateMaxNum) {                	
                    target.find(".screenPaging ul > li:eq(" + templateNum + ") > a").trigger("click");
                } else {                	
                    templateNum = templateMaxNum -1;
                    $(document).off('mousewheel',mouseWheel);
                }
            }
    }
    
    function mainInnerClick(idx) {
        tweening = true;
        target.find(".screenBox").css({"z-index" : 0});
        target.find(".screenBox:eq(" + (templatePrevNum) + ")").css({"z-index" : 1});
        target.find(".screenBox:eq(" + (idx) + ")").css({"z-index" : 2}).show();
        wrapHeight = target.find(".screenBox:eq("+idx+")").height();
        target.find(".mainInner").css({"height" : wrapHeight});
        
        TweenMax.killTweensOf(target);
        if (idx > templatePrevNum) {
            TweenMax.to(target.find(".screenBox:eq(" + (idx) + ")"), 0, {y : "100%"});
            TweenMax.fromTo(target.find(".screenBox:eq(" + (idx) + ")"), twSpeed, {y : "100%"}, {y : "0%", force3D:true, ease : "easeOutQuart",onComplete : tweenEnd});
        } else {
            TweenMax.to(target.find(".screenBox:eq(" + (idx) + ")"), 0, {y : "-100%"});
            TweenMax.fromTo(target.find(".screenBox:eq(" + (idx) + ")"), twSpeed, {y : "-100%"}, {y : "0%", force3D:true, ease : "easeOutQuart",onComplete : tweenEnd});
        }
        templatePrevNum = idx;
        templateNum = idx;
    }

    function tweenEnd() {
        tweening = false;
    }

    function pipTemplateResizeFnc() {    	
        document.body.style.overflow = "hidden";
        var viewportWidth = $(window).width();
        var viewportHeight = $(window).height();
        document.body.style.overflow = "";
        var snbMarginTop = Number($(".snb_pip").css("margin-top").replace("px",""));
        var gnbHeight=$("#header").outerHeight()+$(".snb_pip").outerHeight()+snbMarginTop;
        if(!gnbFlag_vh){
  			gnbHeight=0;
		}
        if (IE_VER < 9 && IE_VER !== false) {
                resizeImg(target.find(".bgInner img"), 1024, 0, innerHeight);
                var imgHeight = target.find(".bgInner img").height();
                var innerHeight = viewportHeight-gnbHeight;
                if(innerHeight > imgHeight){
                    innerHeight = imgHeight;
                }                
                target.find(".bgArea").css("height", innerHeight);
                target.find(".bgInner").css("height", innerHeight);
                target.find(".mainInner").css({"height" : innerHeight});
        } else {
            if (viewportWidth <= TABLET_WIDTH) {
                if (viewportWidth <= MOBILE_WIDTH) {
                    twSpeed = 0;
                    target.find(".bgArea").css("height", "");
                    target.find(".bgInner").css("height", "");
                    target.find(".bgInner img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
                    bgHeight = target.find(".bgInner").height();
                    wrapHeight = target.find(".screenBox:eq("+templateNum+")").height();
                    target.find(".mainInner").css({"height" : wrapHeight});
                    target.find(".pipBtnLeft").css({"position" : "absolute", "height":bgHeight, "top":0, "left":0});
                    target.find(".pipBtnRight").css({"position" : "absolute", "height":bgHeight, "top":0, "right":0});
                    /* S : 180808 */
                    target.find(".screenPagingTxt").css({"height":bgHeight});
                    /* E : 180808 */
                }else{
                    twSpeed = 0.7;
                    target.find(".bgArea").css("height", "");
                    target.find(".bgInner").css("height", "");
                    target.find(".bgInner img").css({"width":"" ,"height":"","margin-left":"","margin-top":""});
                    bgHeight = target.find(".bgInner").height();
                    wrapHeight = target.find(".screenBox:eq("+templateNum+") img").height();
                    target.find(".mainInner").css({"height" : wrapHeight});
                    target.find(".bgInner").css({"height" : wrapHeight});
                    target.find(".bgArea").css({"height" : wrapHeight});
                    target.find(".pipBtnLeft").css({"position" : "absolute", "height":bgHeight, "top":0, "left":0});
                    target.find(".pipBtnRight").css({"position" : "absolute", "height":bgHeight, "top":0, "right":0});
                    /* S : 180808 */
                    target.find(".screenPagingTxt").css({"height":bgHeight});
                    /* E : 180808 */
                }
            } else {
                twSpeed = 0.7;
                
                resizeImg(target.find(".bgInner img"), 0, 0, innerHeight);
                var imgHeight = target.find(".bgInner img").height();
                var innerHeight = viewportHeight-gnbHeight;

                if(innerHeight > imgHeight){
                    innerHeight = imgHeight;
                }

                target.find(".bgArea").css("height", innerHeight);
                target.find(".bgInner").css("height", innerHeight);
                target.find(".mainInner").css({"height" : innerHeight});
            }
        }
    }
}; 


function resizeImg(obj, minW, minH, viewH){
    var $obj = obj;
    var maxWidth = 1920;
    var maxHeight = 1200;
    var winwidth = $(window).width();
    var winheight = $(window).height();
    var minSizeW = minW;
    var minSizeH = minH;
    var ratio = $obj.width() / $obj.height();
    var imgMarginTop=0, imgMarginLeft=0;
    if(winwidth < minSizeW){ winwidth = minSizeW;}
    if(winheight < minSizeH){ winheight = minSizeH;}
    $obj.width(winwidth).height(winheight);
    if(winwidth / ratio >= winheight){
        imgMarginLeft = 0;
        var swidth = Math.min(winwidth,maxWidth);
        imgMarginTop =  Math.ceil((winheight - swidth/ratio)/2);
        var sheight = Math.min(Math.ceil(winwidth/ratio),maxHeight);
        if(winheight > maxHeight){
            imgMarginTop = 0;
        }

        $obj.css({ "width": swidth, "height": sheight,"margin-top": imgMarginTop,"margin-left":"0"});
    }else {
        imgMarginTop = 0;
        imgMarginLeft = Math.ceil((winwidth - winheight*ratio)/2);
        var swidth = Math.min(Math.ceil(winheight*ratio),maxWidth);
        var sheight = Math.min(winheight,maxHeight);
        if(winwidth == maxWidth){
            imgMarginLeft = 0;
        }
        $obj.css({ "height": sheight,"width": swidth,"margin-left" : imgMarginLeft,"margin-top":"0"});
    }
};

//스크롤시 인모션 효과
var vehiclesScrollMotionInit = function(){
    if (IE_VER < 9 && IE_VER !== false) {
        return;
    }
    var lastWindowHeight=800, lastWindowWidth = 800;
    $(window).resize(function() {
        if ($(window).height() != lastWindowHeight || $(window).width() != lastWindowWidth) {
            lastWindowHeight = $(window).height();
            lastWindowWidth = $(window).width();
            $(window).scroll();
        }
        getBrowserHeight_vh();
    });
    
    $(window).scroll(function(screvent) {
        var scrollTop = $(window).scrollTop();
        var winHeight = $(window).height();
        var winWidth = $(window).width();
        $(".vehicles-onScreen").each(function(i, e) {
            if($(this).hasClass("js-onSceen-animateend"))return;
            var elemTop = $(this).offset().top -winHeight;
            var elemBottom = elemTop + $(this).outerHeight();
            var scrollBottom = scrollTop - winHeight
            var isScrollView = (elemTop <= scrollTop && elemBottom >= scrollBottom);
            var use3D = false;
            if(winWidth <= MOBILE_WIDTH){
                use3D = true;
            }
            $(this).css({"position":"relative","opacity":0,"top":100});
            if(isScrollView){
               if(!$(this).hasClass("js-onSceen-animateend")){
                    var self = $(this);
                    function exScrollTweenEnd(){
                        self.css({"position":"","opacity":"","top":""});
                    }
                    TweenMax.to($(this), 0.8, {top:0, force3D:use3D, opacity:1, onComplete:exScrollTweenEnd});
                    $(this).addClass("js-onSceen-animateend");
                }
            }
        }); 
    }).scroll();
};

//차량 템플릿 모바일 사이즈일때 스와이프 생성
var swipeTemplate = function(target){
    var templateNum = 0, templateMaxNum = target.find(".imgListPaging > ul > li").length ,twSpeed = 0.7; 
    var lastLayoutHeight = 800, lastLayoutWidth=800
    var templateSwipe = new onSwipeFnc(target.find(".subInner"));
    /* S : 180808 */
    target.find(".pipBtnLeft").addClass("off");
    target.find(".mInner").append("<div class='screenPagingTxt'>" + "<p><span><span>1</span>/" + templateMaxNum +"</span></p></div>");

    templateSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
        if(phase == "end"){
            if(dir == "right"){
                //console.log("right");
                var idx = templateNum - 1;
                if (idx < 0){
                    //idx = templateMaxNum-1;  
                    //alert("처음 입니다.");
                }else{
                    target.find(".imgListPaging ul > li:eq(" + idx + ") > a").trigger("click");    
                }

            }else if(dir == "left"){
                //console.log("right");
                var idx = templateNum + 1;
                if (idx > templateMaxNum-1){
                    //idx = 0;
                    //alert("마지막 입니다.");
                }else{
                    target.find(".imgListPaging ul > li:eq(" + idx + ") > a").trigger("click");
                }
            }
        }        
    };
     
    target.find(".imgListPaging > ul > li > a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();

        if($(this).parent().index() == 0){
            target.find(".pipBtnLeft").addClass("off");
            target.find(".pipBtnRight").removeClass("off");
        }else if(templateMaxNum -1 == $(this).parent().index()){
            target.find(".pipBtnLeft").removeClass("off");
            target.find(".pipBtnRight").addClass("off");

        }else{
            target.find(".pipBtnLeft").removeClass("off");
            target.find(".pipBtnRight").removeClass("off");
        }


        target.find(".screenPagingTxt").html("<p><span><span>"+ ($(this).parent().index()+1) + "</span>/" + (templateMaxNum) + "</span></p>");
        

        if(!$(this).parent().hasClass("on")){
            target.find(".imgListPaging > ul > li").removeClass("on");
            $(this).parent().addClass("on");
            var idx = $(this).parent().index();
            layoutClick(idx);
        }
    });  
    
    target.find(".pipBtnLeft a.pip_prev").on("click", function(e) {
        e.stopPropagation();
        e.preventDefault();
        var idx = templateNum - 1;
        if (idx < 0){
            //idx = templateMaxNum-1;
            //alert("처음 입니다.");
        }else{
            target.find(".imgListPaging ul > li:eq(" + idx + ") > a").trigger("click");
        }
    });
    
    target.find(".pipBtnRight a.pip_next").on("click", function(e) {
        e.stopPropagation();
        e.preventDefault();
        var idx = templateNum + 1;
        if (idx > templateMaxNum-1) {
            //idx = 0;
            //alert("마지막 입니다.");
            //$(this).hide();
        }else{
            //$(this).show();
            target.find(".imgListPaging ul > li:eq(" + idx + ") > a").trigger("click");
        }
    });

    /* E : 180808 */
    
    function layoutClick(idx){
        target.find(".imgList > li").hide();
        target.find(".imgList > li").eq(idx).show();
        
        templateNum = idx;    
    }  
    
    $(window).resize(function() {
        if($(window).height()!=lastLayoutHeight || $(window).width()!=lastLayoutWidth){
            lastLayoutHeight = $(window).height();
            lastLayoutWidth = $(window).width();
            templateResize();
        }
        getBrowserHeight_vh();
    });
    
    function templateResize(){
        document.body.style.overflow = "hidden";
        var viewportWidth = $(window).width();
        document.body.style.overflow = "";
        if(IE_VER < 9 && IE_VER !== false){ 
             
        }else{
            if(viewportWidth > MOBILE_WIDTH){
               target.find(".imgList li").show();
            }else{
               target.find(".imgList li").hide(); 
               target.find(".imgList li").eq(templateNum).show();
            }    
        }
    }
};

//차량 temp08 모바일 사이즈일때 스와이프 생성
var swipeTemplate2 = function(target){
    var templateNum = 0, templateMaxNum = target.find(".imgListPaging > ul > li").length ,twSpeed = 0.7; 
    var lastLayoutHeight = 800, lastLayoutWidth=800
    var templateSwipe = new onSwipeFnc(target.find(".subInner"));
    /* S : 180808 */
    target.find(".pipBtnLeft").addClass("off");

    templateSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
        if(phase == "end"){
            if(dir == "right"){

                var idx = templateNum - 1;
                if (idx < 0){
                    //idx = templateMaxNum-1;  
                    //alert("처음 입니다.");
                }else{
                    target.find(".imgListPaging ul > li:eq(" + idx + ") > a").trigger("click");    
                }

            }else if(dir == "left"){

                var idx = templateNum + 1;
                if (idx > templateMaxNum-1){
                    //idx = 0;
                    //alert("마지막 입니다.");
                }else{
                    target.find(".imgListPaging ul > li:eq(" + idx + ") > a").trigger("click");
                }
            }
        }        
    };
     
     target.find(".imgListPaging > ul > li > a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();

        if($(this).parent().index() == 0){
            target.find(".pipBtnLeft").addClass("off");
            target.find(".pipBtnRight").removeClass("off");
        }else if(templateMaxNum -1 == $(this).parent().index()){
            target.find(".pipBtnLeft").removeClass("off");
            target.find(".pipBtnRight").addClass("off");

        }else{
            target.find(".pipBtnLeft").removeClass("off");
            target.find(".pipBtnRight").removeClass("off");
        }

        if(!$(this).parent().hasClass("on")){
            target.find(".imgListPaging > ul > li").removeClass("on");
            $(this).parent().addClass("on");
            var idx = $(this).parent().index();
            layoutClick(idx);
        }
    });  
    /* E : 180808 */
    
    
    function layoutClick(idx){
        target.find(".imgList").hide();
        target.find(".imgList").eq(idx).show();
        templateNum = idx;    
    }  
    
    $(window).resize(function() {
        if($(window).height()!=lastLayoutHeight || $(window).width()!=lastLayoutWidth){
            lastLayoutHeight = $(window).height();
            lastLayoutWidth = $(window).width();
            templateResize();
        }
        getBrowserHeight_vh();
    });
    
    function templateResize(){
        document.body.style.overflow = "hidden";
        var viewportWidth = $(window).width();
        document.body.style.overflow = "";
        if(IE_VER < 9 && IE_VER !== false){ 
             
        }else{
            if(viewportWidth > MOBILE_WIDTH){
               target.find(".imgList").show();
            }else{
               target.find(".imgList").hide(); 
               target.find(".imgList").eq(templateNum).show();
            }    
        }
    }
};

//youtube 팝업오픈
var openYoutubePopup = function(obj, type){
    var youtubeID = getURLParameter($(obj).attr("href"),"v"); 
    var youtubeIframe = "<iframe title='youtube 영상' id='youtubeIframe' width='100%' height='100%' src='//www.youtube.com/embed/"+youtubeID+"?enablejsapi=1' frameborder='0' allowfullscreen></iframe>"
    if(type =="type2"){
        $("#featureLayer2 .pop_con dt").text($(obj).find(".btmTextTit").clone().children().remove().end().text());        
        $("#featureLayer2 .pop_con dd").html("<a href='#' class='txt_hidden'>포커스 초점 받기</a>"+$(obj).find(".btmTextTxt").html());
    }else{
        if($(obj).find(".videoText").length){
            $("#featureLayer2 .pop_con dt").text($(obj).find(".videoTit").clone().children().remove().end().text());
            $("#featureLayer2 .pop_con dd").html("<a href='#' class='txt_hidden'>포커스 초점 받기</a>"+$(obj).find(".videoTxt").html());
        }else{
            $("#featureLayer2 .pop_con dt").text($(obj).find(".imgListTit").clone().children().remove().end().text());
            $("#featureLayer2 .pop_con dd").html("<a href='#' class='txt_hidden'>포커스 초점 받기</a>"+$(obj).find(".description").html());    
        }
    }
    
    $("#featureLayer2 .pop_con .youtube").html(youtubeIframe);
    
    var dimPop = new OpenDimPop($("#featureLayer2"), $("#featureLayer2 .pop_con"), {plusHeaderHeight:$(".snb_pip").outerHeight()});
    dimPop.open();
};

//팝업창 호출
var openPipPopup = function(obj,type,desc){
	/* S : 180808 */



    //$(".imgList li > a")
    //$(".tempNewGallery .gallery a")
    var maxLen = 0;
    var objLen = 0;
    
    if($(obj).closest(".imgList").length >= 1){
        
        maxLen = $(obj).closest(".imgList").find("li").length - 1;
        objLen = $(obj).closest(".imgList").find("li").index($(obj).closest("li"));
        //console.log( "max Len : " , maxLen );
        //console.log("objLen :  " , objLen );
        if(maxLen > 0){
            //console.log( "이전버튼 생성 여부 : " , $("#featureLayer1 .pop_con + .prev").length );
            if($("#featureLayer1 .pop_con + .prev").length <= 0){
                $("#featureLayer1 .pop_con").after("<a href='#' class='prev'>Prev</a><a href='#' class='next'>Next</a>")
            }
            $("#featureLayer1 .prev").off("click").on("click", function(e){
                e.preventDefault();
                //console.log("prev", objLen);
                if(objLen <= 0){
                    //console.log("마지막 데이터");
                    /*
                    objLen = maxLen;
                    if($(obj).closest(".imgList").find("li:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type2", "prev" );
                    }else{
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type1", "prev" );
                    }
                    */
                    //alert("처음 입니다.");
                }else{
                    objLen = objLen-1;
                    //console.log("이전");
                     if($(obj).closest(".imgList").find("li:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type2", "prev" );
                    }else{
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type1", "prev" );
                    }
                    //$(obj).closest(".imgList").find("li:eq(" + (objLen - 1)  + ") a").trigger("click")
                }
               // console.log(objLen);
            });

            $("#featureLayer1 .next").off("click").on("click", function(e){
                e.preventDefault();
                //console.log("next", objLen);
                if(objLen >= maxLen){
                    //console.log("마지막 데이터");
                    /*
                    objLen = 0;
                    if($(obj).closest(".imgList").find("li:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type2", "next" );
                    }else{
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type1", "next" );
                    }
                    */
                    //alert("마지막 입니다.");
                }else{
                    objLen = objLen+1;
                    //console.log("다음");
                     if($(obj).closest(".imgList").find("li:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type2", "next" );
                    }else{
                        evtAct($(obj).closest(".imgList").find("li:eq(" + objLen + ") a"), "type1", "next" );
                    }
                    //$(obj).closest(".imgList").find("li:eq(" + (objLen - 1)  + ") a").trigger("click")
                }
            });

            $("#featureLayer1 .prev, #featureLayer1 .next").off("keydown").on("keydown", function(){
                e.stopPropagation();
                e.preventDefault();
            });
        }
        

    }else if($(obj).closest(".tempNewGallery").length >= 1){
        //console.log("evt2");

        maxLen = $(obj).closest(".swiper-wrapper").find(".swiper-slide").length - 1;
        objLen = $(obj).closest(".swiper-wrapper").find(".swiper-slide").index($(obj).closest(".swiper-slide"));
        //console.log( "max Len : " , maxLen );
        //console.log("objLen :  " , objLen );
        if(maxLen > 0){
            //console.log( "이전버튼 생성 여부 : " , $("#featureLayer1 .pop_con + .prev").length );
            if($("#featureLayer1 .pop_con + .prev").length <= 0){
                $("#featureLayer1 .pop_con").after("<a href='#' class='prev'>Prev</a><a href='#' class='next'>Next</a>");
            }
            $("#featureLayer1 .prev").off("click").on("click", function(e){
                e.preventDefault();
                //console.log("prev", objLen);
                if(objLen <= 0){
                    //console.log("마지막 데이터");
                    objLen = maxLen;
                    if($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type2", "prev" );
                    }else{
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type1", "prev" );
                    }
                }else{
                    objLen = objLen-1;
                    //console.log("이전");
                     if($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type2", "prev" );
                    }else{
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type1", "prev" );
                    }
                    //$(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + (objLen - 1)  + ") a").trigger("click")
                }
               // console.log(objLen);
            });

            $("#featureLayer1 .next").off("click").on("click", function(e){
                e.preventDefault();
                //console.log("next", objLen);
                if(objLen >= maxLen){
                    //console.log("마지막 데이터");
                    objLen = 0;
                    if($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type2", "next" );
                    }else{
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type1", "next" );
                    }
                }else{
                    objLen = objLen+1;
                    //console.log("다음");
                     if($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a").find("dl").length){
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type2", "next" );
                    }else{
                        evtAct($(obj).closest(".swiper-wrapper").find(".swiper-slide:eq(" + objLen + ") a"), "type1", "next" );
                    }
                    //$(obj).closest(".swiper-wrapper").find("li:eq(" + (objLen - 1)  + ") a").trigger("click")
                }
            });
        }


    }else{
        $("#featureLayer1 .pop_con + .prev , #featureLayer1 .pop_con + .next ").remove();
    }


    function evtAct(aObj, type, act){
        //console.log("evtAct",aObj , type);
        if(type =="type2"){
            var imgSrc;
            if($(aObj).find("img").attr("layer")){
                imgSrc = $(aObj).find("img").attr("layer");
            }else{
                //picturefill.js 적용을 위한 태그
                if(typeof $(aObj).find("img").attr("srcset") !== "undefined"){
                    imgSrc = $(aObj).find("img:first").attr("srcset");    
                }else{
                    imgSrc = $(aObj).find("img:first").attr("src");
                }
            }
            /*
            $.imgpreload(imgSrc, function(){
                $("#featureLayer1 .pop_con img").attr("src",imgSrc);
                //dimPop.open();
            });
            */

            $("#featureLayer1 .pop_con").removeClass("next prev");
            if(act == "next"){
                setTimeout(function(){
                    $("#featureLayer1 .pop_con").addClass("next");
                    //console.log("act");
                }, 10);
            }else if(act == "prev"){
                setTimeout(function(){
                    $("#featureLayer1 .pop_con").addClass("prev");
                }, 10);
            }

            setTimeout(function(){
                $("#featureLayer1 .pop_con img").attr("src", imgSrc);
                //dimPop.open();
            }, 500);

            
            if(desc==undefined){
                if($(aObj).find(".v_comment").length){
                    $("#featureLayer1 .pop_con dt").text($(aObj).find(".btmTextTit").clone().children().remove().end().text());
                    $("#featureLayer1 .pop_con dd.pop_description").html($(aObj).find(".btmTextTxt").html());
                    $("#featureLayer1 .pop_con dd.pop_comment").html($(aObj).find(".v_comment").html());
                }else{
                    $("#featureLayer1 .pop_con dt").text($(aObj).find(".btmTextTit").clone().children().remove().end().text());
                    $("#featureLayer1 .pop_con dd.pop_description").html($(aObj).find(".btmTextTxt").html());
                    $("#featureLayer1 .pop_con dd.pop_comment").html("");  
                }
            }else{//template07_nodesc 용 함수          
                if($(aObj).find(".v_comment").length){
                    $("#featureLayer1 .pop_con dt").text($(aObj).find(".btmTextTit").clone().children().remove().end().text());
                    $("#featureLayer1 .pop_con dd.pop_description").html(desc);
                    $("#featureLayer1 .pop_con dd.pop_comment").html($(aObj).find(".v_comment").html());
                }else{
                    $("#featureLayer1 .pop_con dt").text($(aObj).find(".btmTextTit").clone().children().remove().end().text());
                    $("#featureLayer1 .pop_con dd.pop_description").html(desc);
                    $("#featureLayer1 .pop_con dd.pop_comment").html("");  
                }
            }
            
            
        }else{
            var imgSrc;
            //console.log($(aObj));
            if($(aObj).find("img").attr("layer")){
                 imgSrc = $(aObj).find("img").attr("layer");
            }else{
                //picturefill.js 적용을 위한 태그
                if(typeof $(aObj).find("img").attr("srcset") !== "undefined"){
                    if($(aObj).find("img").hasClass("carnival")){
                        imgSrc = "/content/dam/kwcms/kr/ko/images/vehicles/all-new-carnival/features/img_allnewcarnival_interior_woodgrein02_w.gif";
                    }else{
                        imgSrc = $(aObj).find("img:first").attr("srcset");
                    }    
                }else{
                    imgSrc = $(aObj).find("img:first").attr("src");
                }
            }
           

            $("#featureLayer1 .pop_con").removeClass("next prev");
            if(act == "next"){
                setTimeout(function(){
                    $("#featureLayer1 .pop_con").addClass("next");
                    console.log("act");
                }, 10);
            }else if(act == "prev"){
                setTimeout(function(){
                    $("#featureLayer1 .pop_con").addClass("prev");
                }, 10);
            }

            setTimeout(function(){
                $("#featureLayer1 .pop_con img").attr("src", imgSrc);
                //dimPop.open();
            }, 500);

            
            if($(aObj).find(".v_comment").length){
                $("#featureLayer1 .pop_con dt").text($(aObj).find(".imgListTit").clone().children().remove().end().text());
                $("#featureLayer1 .pop_con dd.pop_description").html($(aObj).find(".description").html());
                $("#featureLayer1 .pop_con dd.pop_comment").html($(aObj).find(".v_comment").html());
            }else{
                $("#featureLayer1 .pop_con dt").text($(aObj).find(".imgListTit").clone().children().remove().end().text());
                $("#featureLayer1 .pop_con dd.pop_description").html($(aObj).find(".description").html());    
                $("#featureLayer1 .pop_con dd.pop_comment").html(""); 
            }

        }
    }






    /* E : 180808 */
    var dimPop = new OpenDimPop($("#featureLayer1"), $("#featureLayer1 .pop_con"), {plusHeaderHeight:$(".snb_pip").outerHeight()});
    if(type =="type2"){
        var imgSrc;
        if($(obj).find("img").attr("layer")){
            imgSrc = $(obj).find("img").attr("layer");
        }else{
            //picturefill.js 적용을 위한 태그
            if(typeof $(obj).find("img").attr("srcset") !== "undefined"){
                imgSrc = $(obj).find("img:first").attr("srcset");    
            }else{
                imgSrc = $(obj).find("img:first").attr("src");
            }
        }
        $.imgpreload(imgSrc, function(){
            $("#featureLayer1 .pop_con img").attr("src",imgSrc);
            dimPop.open();
        });
        
        if(desc==undefined){
        	if($(obj).find(".v_comment").length){
                $("#featureLayer1 .pop_con dt").text($(obj).find(".btmTextTit").clone().children().remove().end().text());
                $("#featureLayer1 .pop_con dd.pop_description").html($(obj).find(".btmTextTxt").html());
                $("#featureLayer1 .pop_con dd.pop_comment").html($(obj).find(".v_comment").html());
            }else{
                $("#featureLayer1 .pop_con dt").text($(obj).find(".btmTextTit").clone().children().remove().end().text());
                $("#featureLayer1 .pop_con dd.pop_description").html($(obj).find(".btmTextTxt").html());
                $("#featureLayer1 .pop_con dd.pop_comment").html("");  
            }
        }else{//template07_nodesc 용 함수        	
        	if($(obj).find(".v_comment").length){
                $("#featureLayer1 .pop_con dt").text($(obj).find(".btmTextTit").clone().children().remove().end().text());
                $("#featureLayer1 .pop_con dd.pop_description").html(desc);
                $("#featureLayer1 .pop_con dd.pop_comment").html($(obj).find(".v_comment").html());
            }else{
                $("#featureLayer1 .pop_con dt").text($(obj).find(".btmTextTit").clone().children().remove().end().text());
                $("#featureLayer1 .pop_con dd.pop_description").html(desc);
                $("#featureLayer1 .pop_con dd.pop_comment").html("");  
            }
        }
        
        
    }else{
        var imgSrc;
        if($(obj).find("img").attr("layer")){
             imgSrc = $(obj).find("img").attr("layer");
        }else{
            //picturefill.js 적용을 위한 태그
            if(typeof $(obj).find("img").attr("srcset") !== "undefined"){
            	if($(obj).find("img").hasClass("carnival")){
            		imgSrc = "/content/dam/kwcms/kr/ko/images/vehicles/all-new-carnival/features/img_allnewcarnival_interior_woodgrein02_w.gif";
            	}else{
            		imgSrc = $(obj).find("img:first").attr("srcset");
            	}    
            }else{
                imgSrc = $(obj).find("img:first").attr("src");
            }
        }
       
        $.imgpreload(imgSrc, function(){
            $("#featureLayer1 .pop_con img").attr("src", imgSrc);
            dimPop.open();
        });
        
        if($(obj).find(".v_comment").length){
            $("#featureLayer1 .pop_con dt").text($(obj).find(".imgListTit").clone().children().remove().end().text());
            $("#featureLayer1 .pop_con dd.pop_description").html($(obj).find(".description").html());
            $("#featureLayer1 .pop_con dd.pop_comment").html($(obj).find(".v_comment").html());
        }else{
            $("#featureLayer1 .pop_con dt").text($(obj).find(".imgListTit").clone().children().remove().end().text());
            $("#featureLayer1 .pop_con dd.pop_description").html($(obj).find(".description").html());    
            $("#featureLayer1 .pop_con dd.pop_comment").html(""); 
        }
    }
};

//스펙 초기화
var specInit = function(){
    var viewportWidth, specNum = 0, specMaxNum, specLiWidth, engineNum = 0, engineMaxNum, engineLiWidth, engineColumn, wheelColumn, wheelNum = 0, wheelMaxNum, wheelLiWidth;

    initCss();
    initListener();
    
    function initCss(){
        specLiWidth  = $(".spec_slide_area .spec_img > ul > li").width();
        specMaxNum = $(".spec_slide_area .spec_img > ul > li").length;
        $(".spec_slide_area a.spec_prev").hide();
        
        engineLiWidth  = $(".engine_slide_area .img_wrap > ul > li").width();
        engineMaxNum = $(".engine_slide_area .img_wrap > ul > li").length;
        $(".engine_slide_area a.spec_prev").hide();
        
        wheelLiWidth  = $(".wheel_slide_area .img_wrap > ul > li").width();
        wheelMaxNum = $(".wheel_slide_area .img_wrap > ul > li").length;
        $(".wheel_slide_area a.spec_prev").hide();
    }
    
    function initListener(){
        //dimension
        //트립리스트 열기
        $("a.select_trim").on("click",function(e){
            e.stopPropagation();
            e.preventDefault();
            if($(this).parent().siblings(".car_trim_list").css("display") == "block"){
                $(this).parent().siblings(".car_trim_list").hide();    
            }else{
                $(this).parent().siblings(".car_trim_list").show();    
            }        
        });        
        
        if($(".car_trim_list").length){
            $(document).bind('click.car_trim_list',function(){
               $(".car_trim_list").hide();    
            });
        }
        
      //트립선택
        $("ul.car_trim_list li a").on("click",function(e){
            e.preventDefault();
            $(".car_trim_list").hide();
            var trimText = $(this).text();
            $(this).closest("ul").siblings(".current").find("a.select_trim span").text(trimText);
            var idx = $(this).parent().index();
            //setTrim(idx);
        });
        
       function setTrim(idx){
           var frontImgSrc = frontAry[idx].fileReference;
           var fronttabletSrc = frontAry[idx].fileReference.replace("_w.", "_t.");
           var frontmobileSrc = frontAry[idx].fileReference.replace("_w.", "_m.");
           var frontalt = frontAry[idx].alt;
           var imgUlLi = "";
           imgUlLi += "<li><div class='imgArea'><img src='"+frontImgSrc +"' class='webImg' alt='"+frontalt +"'><img src='"+fronttabletSrc +"' class='tabletImg' alt='"+frontalt +"'><img src='"+frontmobileSrc +"' class='mobileImg' alt='"+frontalt +"'></div></li>";

           var rearImgSrc = rearAry[idx].fileReference;
           var reartabletSrc = rearAry[idx].fileReference.replace("_w.", "_t.");
           var rearmobileSrc = rearAry[idx].fileReference.replace("_w.", "_m.");
           var rearalt = rearAry[idx].alt;
           imgUlLi += "<li><div class='imgArea'><img src='"+rearImgSrc +"' class='webImg' alt='"+rearalt +"'><img src='"+reartabletSrc +"' class='tabletImg' alt='"+rearalt +"'><img src='"+rearmobileSrc +"' class='mobileImg' alt='"+rearalt +"'></div></li>";

           var sideImgSrc = sideAry[idx].fileReference;
           var sidetabletSrc = sideAry[idx].fileReference.replace("_w.", "_t.");
           var sidemobileSrc = sideAry[idx].fileReference.replace("_w.", "_m.");
           var sidealt = sideAry[idx].alt;
           imgUlLi += "<li><div class='imgArea'><img src='"+sideImgSrc +"' class='webImg' alt='"+sidealt +"'><img src='"+sidetabletSrc +"' class='tabletImg' alt='"+sidealt +"'><img src='"+sidemobileSrc +"' class='mobileImg' alt='"+sidealt +"'></div></li>";
           
           var allFrontImgSrc = entireFrontAry[idx].fileReference;
           var allFrontalt = entireFrontAry[idx].alt;
           var allviewUlLi = "";
           allviewUlLi += "<li><img src='" +allFrontImgSrc +"' alt='"+allFrontalt +"'/></li>";
           
           $(".spec_slide_area .spec_img ul").html(imgUlLi);
           $(".spec_allview_area .spec_img ul").html(allviewUlLi);
           specPosSet(0,0);
       }
    
        $(".spec_data ul.m_none > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            $(".spec_data ul.m_none > li > a").removeClass("on");
            $(this).addClass("on");
           
            if($(this).hasClass("btn_slide")){
                $(".spec_slide_area").show();
                $(".spec_allview_area").hide();
            }else{
                $(".spec_slide_area").hide();
                $(".spec_allview_area").show();
            }
        });
        
        $(".spec_img a.spec_next").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = specNum+1;
            specPosSet(idx,0.5);
        });
        
        $(".spec_img a.spec_prev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
           var idx = specNum-1;
            specPosSet(idx,0.5);
        });
        
        $(".spec_slide_area .control ul.num > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = $(this).parent().index();
            specPosSet(idx,0.5);
        });
        
        //engine
        $(".engine_data ul > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            $(".engine_data ul > li > a").removeClass("on");
            $(this).addClass("on");
            if($(this).hasClass("btn_slide")){
                $(".engine_slide_area").show();
                $(".engine_allview_area").hide();
                engineColumn = 0;
                $(".engine_visual").css("height","");
            }else{
                $(".engine_slide_area").hide();
                $(".engine_allview_area").show();
                if($(".engine_allview_area").hasClass("engineType04") || $(".engine_allview_area").hasClass("engineType05")){
                    engineColumn = 2;
                }else{
                    engineColumn = 1;
                }
                engineSetColum();
            }
        });
        
        function engineSetColum(){
            if(viewportWidth < TABLET_WIDTH){
                if(engineColumn == 2){
                    $(".engine_visual").css("height",820);
                }else{
                    $(".engine_visual").css("height","");
                }
            }else{
                if(engineColumn == 2){
                      $(".engine_visual").css("height",1000);
                 }else{
                      $(".engine_visual").css("height",726);
                 }
            }
              
        }
        
        $(".engine_slide_area a.spec_next").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = engineNum+1;
            enginePosSet(idx,0.5);
        });
        
        $(".engine_slide_area a.spec_prev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
           var idx = engineNum-1;
            enginePosSet(idx,0.5);
        });
        
        $(".engine_slide_area .control ul.num > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = $(this).parent().index();
            enginePosSet(idx,0.5);
        });
        
         //wheel
        $(".wheel_data ul > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            $(".wheel_data ul > li > a").removeClass("on");
            $(this).addClass("on");
            if($(this).hasClass("btn_slide")){
                $(".wheel_slide_area").show();
                $(".wheel_allview_area").hide();
                //wddo
                wheelColumn = 0;
                $(".wheel_visual").css("height", "");
                //
            }else{
                $(".wheel_slide_area").hide();
                $(".wheel_allview_area").show();
                //wddo
                if($(".wheel_allview_area").hasClass("wheelType04") || $(".wheel_allview_area").hasClass("wheelType05") || $(".wheel_allview_area").hasClass("wheelType06")){
                    wheelColumn = 2;
                }else{
                    wheelColumn = 1;
                }
                wheelSetColum();
            }
        });
        
        //wddo
        function wheelSetColum(){
            if(viewportWidth < TABLET_WIDTH){
                if(wheelColumn == 2){
                    $(".wheel_visual").css("height",820);
                }else{
                    $(".wheel_visual").css("height","");
                }
            }else{
                if(wheelColumn == 2){
                      $(".wheel_visual").css("height",960);
                 }else{
                      $(".wheel_visual").css("height",726);
                 }
            }
        }
        
        $(".wheel_slide_area a.spec_next").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = wheelNum+1;
            wheelPosSet(idx,0.5);
        });
        
        $(".wheel_slide_area a.spec_prev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
           var idx = wheelNum-1;
            wheelPosSet(idx,0.5);
        });
        
        $(".wheel_slide_area .control ul.num > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = $(this).parent().index();
            wheelPosSet(idx,0.5);
        });
        
        mobileSpec();
        mobileEngine();
        mobileWheel();
    }
    
    function mobileSpec(){
        $(".pip_spec .spec_list_title > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            if(viewportWidth <= MOBILE_WIDTH){
                 if($(this).hasClass("on")){
                     $(this).removeClass("on");
                     $(this).parent().siblings(".spec_view").hide();
                 }else{
                     $(this).addClass("on");
                     $(this).parent().siblings(".spec_view").show();
                 }
            }
        });
        
        var specSwipe = new onSwipeFnc(".spec_slide_area .spec_img");
        specSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
        if(phase == "end"){
              if(dir == "right"){
                  var idx = specNum-1;
                  if(idx < 0) idx =0;
                  $(".spec_slide_area .control ul.num > li:eq("+ idx +") > a").trigger("click");
              }else if(dir == "left"){
                  var idx = specNum+1;
                  if(idx > specMaxNum-1) idx = specMaxNum-1;
                  $(".spec_slide_area .control ul.num > li:eq("+ idx +") > a").trigger("click");
              }
          }        
      };
    }
    
    function mobileEngine(){
        $(".pip_engine .spec_list_title:eq(0) > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
             if(viewportWidth <= MOBILE_WIDTH){
                 if($(this).hasClass("on")){
                     $(this).removeClass("on");
                     $(this).parent().siblings(".spec_view:eq(0)").hide();
                 }else{
                     $(this).addClass("on");
                     $(this).parent().siblings(".spec_view:eq(0)").show();
                 }
            }
        });
        
        $(".pip_engine .spec_list_title:eq(1) > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
             if(viewportWidth <= MOBILE_WIDTH){
                 if($(this).hasClass("on")){
                     $(this).removeClass("on");
                     $(this).parent().siblings(".spec_view:eq(1)").hide();
                 }else{
                     $(this).addClass("on");
                     $(this).parent().siblings(".spec_view:eq(1)").show();
                 }
            }
        });
        
        var engineSwipe = new onSwipeFnc(".engine_slide_area .img_wrap");
        engineSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
        if(phase == "end"){
              if(dir == "right"){
                  var idx = engineNum-1;
                  if(idx < 0) idx =0;
                  $(".engine_slide_area .control ul.num > li:eq("+ idx +") > a").trigger("click");
              }else if(dir == "left"){
                  var idx = engineNum+1;
                  if(idx > engineMaxNum-1) idx = engineMaxNum-1;
                  $(".engine_slide_area .control ul.num > li:eq("+ idx +") > a").trigger("click");
              }
          }        
      };
    }
    
    function mobileWheel(){
        $(".pip_wheel .spec_list_title > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
             if(viewportWidth <= MOBILE_WIDTH){
                 if($(this).hasClass("on")){
                     $(this).removeClass("on");
                     $(this).parent().siblings(".spec_view").hide();
                 }else{
                     $(this).addClass("on");
                     $(this).parent().siblings(".spec_view").show();
                 }
            }
        });
        
        var engineSwipe = new onSwipeFnc(".wheel_slide_area .img_wrap");
        engineSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
        if(phase == "end"){
              if(dir == "right"){
                  var idx = wheelNum-1;
                  if(idx < 0) idx =0;
                  $(".wheel_slide_area .control ul.num > li:eq("+ idx +") > a").trigger("click");
              }else if(dir == "left"){
                  var idx = wheelNum+1;
                  if(idx > wheelMaxNum-1) idx = wheelMaxNum-1;
                  $(".wheel_slide_area .control ul.num > li:eq("+ idx +") > a").trigger("click");
              }
          }        
      };
    }
        
    function specPosSet(idx,duration){
        $(".spec_slide_area .control ul.num > li").removeClass("on");
        $(".spec_slide_area .control ul.num > li").eq(idx).addClass("on");
        specLiWidth = $(".spec_slide_area .spec_img > ul > li").width();
        TweenMax.to($(".spec_slide_area .spec_img > ul"), duration, {marginLeft: specLiWidth *-idx,  ease:"easeOutExpo", force3D:true});
        specNum = idx;
        if(specNum == 0){
            $(".spec_img a.spec_next").show();
            $(".spec_img a.spec_prev").hide();
        }else if(specNum == specMaxNum-1){
            $(".spec_img a.spec_next").hide();
            $(".spec_img a.spec_prev").show();
        }else{
            $(".spec_img a.spec_next").show();
            $(".spec_img a.spec_prev").show();
        }
        
        //wddo
        if ($(".spec_slide_area .spec_img > ul > li").length <= 1) {
            $(".spec_img a.spec_next").hide();
            $(".spec_img a.spec_prev").hide();
        }
    }
    
      
    function enginePosSet(idx,duration){
        $(".engine_slide_area .control ul.num > li").removeClass("on");
        $(".engine_slide_area .control ul.num > li").eq(idx).addClass("on");
        engineLiWidth = $(".engine_slide_area .img_wrap > ul > li").width();
        TweenMax.to($(".engine_slide_area .img_wrap > ul"), duration, {marginLeft: engineLiWidth *-idx,  ease:"easeOutExpo", force3D:true});
        engineNum = idx;
        if(engineNum == 0){
            $(".engine_slide_area a.spec_next").show();
            $(".engine_slide_area a.spec_prev").hide();
        }else if(engineNum == engineMaxNum-1){
            $(".engine_slide_area a.spec_next").hide();
            $(".engine_slide_area a.spec_prev").show();
        }else{
            $(".engine_slide_area a.spec_next").show();
            $(".engine_slide_area a.spec_prev").show();
        }
        
        //wddo
        if ($(".engine_slide_area .img_wrap > ul > li").length <= 1) {
            $(".engine_slide_area a.spec_next").hide();
            $(".engine_slide_area a.spec_prev").hide();
        }
    }
    
    function wheelPosSet(idx,duration){
        $(".wheel_slide_area .control ul.num > li").removeClass("on");
        $(".wheel_slide_area .control ul.num > li").eq(idx).addClass("on");
        wheelLiWidth = $(".wheel_slide_area .img_wrap > ul > li").width();
        TweenMax.to($(".wheel_slide_area .img_wrap > ul"), duration, {marginLeft: wheelLiWidth *-idx,  ease:"easeOutExpo", force3D:true});
        wheelNum = idx;
        if(wheelNum == 0){
            $(".wheel_slide_area a.spec_next").show();
            $(".wheel_slide_area a.spec_prev").hide();
        }else if(wheelNum == wheelMaxNum-1){
            $(".wheel_slide_area a.spec_next").hide();
            $(".wheel_slide_area a.spec_prev").show();
        }else{
            $(".wheel_slide_area a.spec_next").show();
            $(".wheel_slide_area a.spec_prev").show();
        }
        
        //wddo
        if ($(".wheel_slide_area .img_wrap > ul > li").length <= 1) {
            $(".wheel_slide_area a.spec_next").hide();
            $(".wheel_slide_area a.spec_prev").hide();
        }
    }
    
    $(window).resize(function() {
        if($(window).height()!=lastWindowHeight || $(window).width()!=lastWindowWidth){
            lastWindowHeight = $(window).height();
            lastWindowWidth = $(window).width();
            specPosResize();
        }
        getBrowserHeight_vh();
    }).resize();
        
    function specPosResize(){
        document.body.style.overflow = "hidden";
        viewportWidth = $(window).width();
        document.body.style.overflow = "";
        var scrollWidth = viewportWidth - $(window).width();
        specPosSet(specNum,0);
        enginePosSet(engineNum,0);
        wheelPosSet(wheelNum,0);
        
        if(IE_VER < 9 && IE_VER !== false){ 
             
        }else{
            if(viewportWidth > MOBILE_WIDTH){
                $(".spec_view").show();
                $(".pip_spec .spec_list_title > a").addClass("on");
                $(".pip_engine .spec_list_title > a").addClass("on");
                $(".pip_wheel .spec_list_title > a").addClass("on");
                $(".pip_wheel .scroll_inner").css("width","");
                if(viewportWidth < TABLET_WIDTH){
                    if(engineColumn == 2){
                        $(".engine_visual").css("height",820);
                    }else{
                        $(".engine_visual").css("height","");
                    }
                    //wddo
                    if(wheelColumn == 2){
                        $(".wheel_visual").css("height",820);
                    }else{
                        $(".wheel_visual").css("height","");
                    }
                }else{
                    if(engineColumn == 2){
                        $(".engine_visual").css("height",1000);
                    }else{
                        $(".engine_visual").css("height","");
                    }
                    //wddo
                    if(wheelColumn == 2){
                        $(".wheel_visual").css("height",960);
                    }else{
                        $(".wheel_visual").css("height", "");
                    }
                }
            }else{
                engineColumn = 0;
                wheelColumn = 0;
                $(".spec_data ul > li > a.btn_slide").addClass("on");
                $(".spec_data ul > li > a.btn_allview").removeClass("on");
                $(".spec_slide_area").show();
                $(".spec_allview_area").hide();
                
                $(".engine_data ul > li > a.btn_slide").addClass("on");
                $(".engine_data ul > li > a.btn_allview").removeClass("on");
                $(".engine_slide_area").show();
                $(".engine_allview_area").hide();
                $(".engine_visual").css("height","");
                
                $(".wheel_data ul > li > a.btn_slide").addClass("on");
                $(".wheel_data ul > li > a.btn_allview").removeClass("on");
                $(".wheel_slide_area").show();
                $(".wheel_allview_area").hide();
                $(".wheel_visual").css("height",""); //wddo
                $(".pip_wheel .scroll_inner").css("width",viewportWidth - scrollWidth);
            }    
        }
    }
};

//상용제원스펙
var businessInit = function(){
    var viewportWidth;
    
    $(window).resize(function() {
        if($(window).height()!=lastWindowHeight || $(window).width()!=lastWindowWidth){
            lastWindowHeight = $(window).height();
            lastWindowWidth = $(window).width();
            businessPosResize();
        }
        getBrowserHeight_vh();
    }).resize();
    
     $(".spec_list_title > a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        if(viewportWidth <= MOBILE_WIDTH){
             if($(this).hasClass("on")){
                 $(this).removeClass("on");
                 $(this).parent().siblings(".spec_view").hide();
             }else{
                 $(this).addClass("on");
                 $(this).parent().siblings(".spec_view").show();
             }
        }
    });
        
    $(".form_select").on("change",function(e){
        e.stopPropagation();
        e.preventDefault();
        var idx = $(this).getSetSSValue();
        $(".tab_contents").css("display","none");
        $(".tab_contents").eq(idx).css("display","block");
    });
    
    
    function businessPosResize(){
        document.body.style.overflow = "hidden";
        viewportWidth = $(window).width();
        document.body.style.overflow = "";
        var scrollWidth = viewportWidth - $(window).width() + 30;
        
        if(IE_VER < 9 && IE_VER !== false){ 
             
        }else{
            if(viewportWidth > MOBILE_WIDTH){
                $(".spec_view").css("overflow","");
                $(".spec_view .scroll_inner").css("width","");
                $(".spec_list .spec_view").show();
                $(".spec_list_title > a").addClass("on");
            }else{
                $(".spec_view").css("overflow","hidden");
                $(".spec_view .scroll_inner").css("width",viewportWidth - scrollWidth);
            }    
        }
    }
}; 


//gallery
var galleryInit = function(){
     var k=1, persent;
     var viewportWidth, pipInerHeight, interiorMaxNum, exteriorMaxNum, videoMaxNum, isExteriorOpen = false, isInteriorOpen = false, isVideoOpen = false, isDetailViewOpen = false,
          interiorNum = 0, exteriorNum = 0, videoNum = 0;
    
    window.onload = function(e){ 
            loadComplete();
    };
    
     function loadComplete(){
        gallerySetHeight();
    }
 
    initCss();
    initListener();
    
    var videoPop = new OpenDimPop($("#videoLayer"), $("#videoLayer .pop_con"), {plusHeaderHeight:$(".snb_pip").outerHeight()});
    
    function initCss(){
        $(".gallery_exterior").hide();
        $(".gallery_interior").hide();
        
        if($(".gallery_video").length){
            $(".gallery_video").hide();    
        }else{
            //video가없으면 버튼숨김
            $("a.bg_video").hide();  
        }
        
        $(".mouse_evt").hide();
    }
      
    function initListener(){
        interiorMaxNum = $(".gallery_interior .wide_wrap .gallery_paging ul > li").length;
        exteriorMaxNum = $(".gallery_exterior .wide_wrap .gallery_paging ul > li").length;
        videoMaxNum = $(".gallery_video .wide_wrap .gallery_paging ul > li").length;
        
        $(window).resize(function() {
            if($(window).height()!=lastWindowHeight || $(window).width()!=lastWindowWidth){
                lastWindowHeight = $(window).height();
                lastWindowWidth = $(window).width();
                gallerySetHeight();
            }
            getBrowserHeight_vh();
        }).resize();
       
        $("a.exterior").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            openFirstExterior();
        });
        
        
        $("a.interior").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            openFirstInterior();
        });   
         
         
        $("a.bg_ext").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            openExterior();
        });
        
        $("a.bg_int").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            openInterior();
        });
        
         $("a.bg_video").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            openVideo();
        });
        
        $("a.wide_close").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            closeWideGallery();
        });    
        
        $(".gallery_exterior a.wide_prev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            exteriorPrev();
        });   
        
         $(".gallery_exterior a.wide_next").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            exteriorNext();
        });   
        
        $(".gallery_interior a.wide_prev").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            interiorPrev();
        });   
        
         $(".gallery_interior a.wide_next").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            interiorNext();
        });   
     
        $(".gallery_exterior .gallery_wrap ul.screen > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = $(this).parent().index();
            exteriorNum = idx;
           openExDetailImage();
        });
        
        $(".gallery_interior .gallery_wrap ul.screen > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var idx = $(this).parent().index();
            interiorNum = idx;
            openInDetailImage();
        });
        
        $(".gallery_video .gallery_wrap ul.screen > li > a").on("click", function(e){
            e.stopPropagation();
            e.preventDefault();
            var youtubeID = getURLParameter($(this).attr("href"),"v"); 
            var youtubeIframe = "<iframe title='youtube 영상' id='youtubeIframe' width='100%' height='100%' src='//www.youtube.com/embed/"+youtubeID+"?enablejsapi=1' frameborder='0' allowfullscreen></iframe>"
            $("#videoLayer .pop_con .youtube").html(youtubeIframe);
            openGalleryVideoPopup(this);
        });
        
        $(".gallery_wrap ul.screen > li > a").on("mouseenter", function(e){
            var iOS = ( navigator.userAgent.match(/(iPad|iPhone|iPod)/g) ? true : false );
            if(iOS){return;}
            if(viewportWidth < MOBILE_WIDTH){return;}
            if($(this).find("span.hover").length){
                $(this).find("span.hover").remove();    
            }
            $(this).append("<span class=\"hover\"></span>");
        });
        
        $(".gallery_wrap ul.screen > li > a").on("mouseleave", function(e){
            if(viewportWidth < MOBILE_WIDTH){return;}
             if($(this).find("span.hover").length){
                $(this).find("span.hover").remove();    
            }
        });
        
        var locationHash = window.location.hash
        if(locationHash == "#exterior"){
            $("a.exterior").trigger("click");
        }else if(locationHash == "#interior"){
            $("a.interior").trigger("click");
        }
    }
    
    function exteriorPrev(){
        var idx = exteriorNum-1;
        if(idx < 0) idx = exteriorMaxNum-1;
        exteriorDetailViewSet(idx);
    }
    
    function exteriorNext(){
        var idx = exteriorNum +1;
        if(idx > exteriorMaxNum-1) idx = 0;
        exteriorDetailViewSet(idx);
    }
    
    //익스테리어 자세히 보기
    function exteriorDetailViewSet(idx){
        $(".gallery_exterior .wide_gallery .img_wrap > div").hide();
        $(".gallery_exterior .wide_gallery .img_wrap > div").eq(idx).show();
        $(".gallery_exterior .wide_wrap .gallery_paging > ul > li").removeClass("on");
        $(".gallery_exterior .wide_wrap .gallery_paging > ul > li").eq(idx).addClass("on");
        exteriorNum = idx;
        if($("*:focus").length > 0 &&  viewportWidth > MOBILE_WIDTH){
           if(tapIndexFnc.focusedElementBeforeModal){return;}
           tapIndexFnc.Init($(".wide_wrap"));
        }
    }
    
    function interiorPrev(){
        var idx = interiorNum-1;
        if(idx < 0) idx = interiorMaxNum-1;
        interiorDetailViewSet(idx);
    }
    
    function interiorNext(){
        var idx = interiorNum+1;
        if(idx > interiorMaxNum-1) idx = 0;
        interiorDetailViewSet(idx);
    }
    
    //인테리어 자세히 보기
    function interiorDetailViewSet(idx){
        $(".gallery_interior .wide_gallery .img_wrap > div").hide();
        $(".gallery_interior .wide_gallery .img_wrap > div").eq(idx).show();
        $(".gallery_interior .wide_wrap .gallery_paging > ul > li").removeClass("on");
        $(".gallery_interior .wide_wrap .gallery_paging > ul > li").eq(idx).addClass("on");
        interiorNum = idx;    
        if($("*:focus").length > 0 &&  viewportWidth > MOBILE_WIDTH){
           if(tapIndexFnc.focusedElementBeforeModal){return;}
           tapIndexFnc.Init($(".wide_wrap"));
        }
    }

   
    //비디오 자세히 보기
    function openGalleryVideoPopup(obj){
        $("#videoLayer .pop_con .img_more dt").text($(obj).find(".title").clone().children().remove().end().text());
        $("#videoLayer .pop_con .img_more dd").text($(obj).find(".overview").clone().children().remove().end().text());

        videoPop.open();
        
        if($("*:focus").length > 0 &&  viewportWidth > MOBILE_WIDTH){
           tapIndexFnc.Init($(".wide_wrap"));
        }
    }

    function closeWideGallery(){
        $(".screen_wrap").show();
        $(".wide_gallery").hide();
       
        isDetailViewOpen = false;
        gallerySetHeight();
        if($("*:focus").length > 0){
           tapIndexFnc.Close();
        }
    }
    
    function openExDetailImage(){
        $(".gallery_exterior .wide_gallery").fadeIn();
        exteriorDetailViewSet(exteriorNum);
        isDetailViewOpen = true;  
        $(".gallery_exterior .screen_wrap").hide();
        gallerySetHeight();
    }
    
    function openInDetailImage(){
        $(".gallery_interior .wide_gallery").fadeIn();
        interiorDetailViewSet(interiorNum);
        isDetailViewOpen = true;
        $(".gallery_interior .screen_wrap").hide();
        gallerySetHeight();
    }
    
    //게이트에서 처음 익스테리어 클릭시
    function openFirstExterior(){
        $(".gallery_exterior").show();
        $("body,html").stop().animate({"scrollTop": 0}, 500, function(){
            TweenMax.to($(".pip_inner"), 0.7, {marginLeft:"-100%", ease:"easeInExpo", onComplete:openComplete, onCompleteParams:["ex"]});
        });
    }
    
    //게이트에서 처음 인테리어 클릭시
    function openFirstInterior(){
        $(".gallery_interior").show();
        $("body,html").stop().animate({"scrollTop": 0}, 500, function(){
            TweenMax.to($(".pip_inner"), 0.7, {marginLeft:"-200%",  ease:"easeInExpo", onComplete:openComplete, onCompleteParams:["in"]});
        });
    }
        
    function openExterior(){
        $(".gallery_exterior").show();
        $(".pip_inner").css("margin-left","-100%");   
        $("body,html").stop().animate({"scrollTop": 0}, 500, function(){
            TweenMax.to($(".pip_inner"), 0.7, {marginLeft:"0%", ease:"easeInExpo", onComplete:openComplete, onCompleteParams:["ex"]});    
        });
    }
    
    function openInterior(){
        $(".gallery_interior").show();
        if(isVideoOpen == true){
            $(".pip_inner").css("margin-left","-100%");
            $("body,html").stop().animate({"scrollTop": 0}, 500, function(){
                TweenMax.to($(".pip_inner"), 0.7, {marginLeft:"0%",  ease:"easeInExpo", onComplete:openComplete, onCompleteParams:["in"]});
            });  
        }else{
            $(".pip_inner").css("margin-left",0);    
            $("body,html").stop().animate({"scrollTop": 0}, 500, function(){
                TweenMax.to($(".pip_inner"), 0.7, {marginLeft:"-100%",  ease:"easeInExpo", onComplete:openComplete, onCompleteParams:["in"]});
            });
        }
    }
    
    function openVideo(){
        $(".gallery_video").show();
        $(".pip_inner").css("margin-left",0);
        $("body,html").stop().animate({"scrollTop": 0}, 500, function(){
            TweenMax.to($(".pip_inner"), 0.7, {marginLeft:"-100%",  ease:"easeInExpo", onComplete:openComplete, onCompleteParams:["video"]});
        });
    }
    
    
    function openComplete(openTarget){
        isExteriorOpen = false;
        isInteriorOpen = false;
        isVideoOpen = false;
        var screenLength;
        $(".pip_inner").css("margin-left",0);
        if(openTarget == "ex"){
            isExteriorOpen = true;
            screenLength = $(".gallery_exterior .screen li").length;
            $(".gallery_interior").hide();
            if($("*:focus").length > 0){
                setTimeout(function(){$(".gallery_exterior ul.screen li:eq(0) a").focus();}, 300); 
            }
        }else if(openTarget == "in"){
            isInteriorOpen = true;
            screenLength = $(".gallery_interior .screen li").length;
            $(".gallery_exterior").hide();   
            if($("*:focus").length > 0){
                setTimeout(function(){$(".gallery_interior ul.screen li:eq(0) a").focus();}, 300);
            } 
        }else{
            isVideoOpen = true;
            screenLength = $(".gallery_video .screen li").length;
            $(".gallery_interior").hide();    
            $(".gallery_exterior").hide();   
            if($("*:focus").length > 0){
                setTimeout(function(){$(".gallery_video ul.screen li:eq(0) a").focus();}, 300);
            }
        }
        $(window).on("scroll", galleryScroll);
        if(screenLength > 6){
            $(".mouse_evt").fadeIn().delay(1000).fadeOut(300);
        }else{
            $(".mouse_evt").hide();
        }
        $(".gallery_select").hide();
        gallerySetHeight();
    }
    
    function galleryScroll(){
        $(window).off("scroll", galleryScroll);
        $(".mouse_evt").fadeOut(300);
    }
    
    //gallery 윈도우 높이가 낮을때 네비 위치 변경
    var galleryScrollTop;
    $(window).scroll(function(screvent) {
         galleryScrollTop = $(window).scrollTop();
         if(galleryScrollTop > 135){
             galleryScrollTop = galleryScrollTop-135;
         }else{
             galleryScrollTop = 135;
         }
        if ($(window).height() < 683) {
            $(".nav_fixed").css({"position" : "absolute","top" : galleryScrollTop});
        } else {
            $(".nav_fixed").css({"position": "fixed","top" :135});
        }
    });
    
    function gallerySetHeight(){
        document.body.style.overflow = "hidden";
        viewportWidth = $(window).width();
        document.body.style.overflow = "";
        if(isExteriorOpen == true){
            galleryWrapHeight = $(".gallery_exterior").height();    
        }else if(isInteriorOpen == true){
            galleryWrapHeight = $(".gallery_interior").height();
        }else if(isVideoOpen == true){
            galleryWrapHeight = $(".gallery_video").height();
        }else{
            galleryWrapHeight = $(".gallery_select").height();
        }
        if(isDetailViewOpen == true){
            if(isExteriorOpen){
                galleryWrapHeight = $(".gallery_exterior .wide_gallery").height();    
            }else if(isInteriorOpen){
                galleryWrapHeight = $(".gallery_interior .wide_gallery").height();
            }else if(isVideoOpen){
                galleryWrapHeight = $(".gallery_video .wide_gallery").height();
            }
        }
        $(".width_wrap").css("height",galleryWrapHeight);
        
        
        if(IE_VER < 9 && IE_VER !== false){ 
             
        }else{
            if($(window).height()  < 683){
                $(".nav_fixed").css({"position":"absolute","top":galleryScrollTop});
            }else{
                $(".nav_fixed").css({"position": "fixed","top" :135});
            }
            if(viewportWidth > MOBILE_WIDTH){
              $(".wideBtnLeft").css({"position":"","height":"","top":"","left":""});
              $(".wideBtnRight").css({"position":"","height":"","top":"","right":""});
                if(isExteriorOpen){
                   $(".gallery_interior").hide();
                   $(".gallery_exterior").show(); 
                   $(".gallery_video").hide();      
                }else if(isInteriorOpen){
                   $(".gallery_interior").show();
                   $(".gallery_exterior").hide(); 
                   $(".gallery_video").hide();
                }else if(isVideoOpen){
                   $(".gallery_interior").hide();
                   $(".gallery_exterior").hide(); 
                   $(".gallery_video").show();
                }
            }else{
              $(".mouse_evt").hide();
              $(".gallery_interior").show();    
              $(".gallery_exterior").show();
              $(".gallery_video").show();
              $(".width_wrap").css("height","");
              
              var  imgHeight = $(".img_wrap > div:eq("+exteriorNum+") img").height();
              $(".wideBtnLeft").css({"position":"absolute","height":imgHeight,"top":"35px","left":"0px"});
              $(".wideBtnRight").css({"position":"absolute","height":imgHeight,"top":"35px","right":"0px"});
            }    
        }
    }
    
    mobileExterior();
    mobileInterior();
    mobilevideo();
    
    function mobileExterior(){
        var exteriorSwipe = new onSwipeFnc(".gallery_exterior .wide_wrap .img_wrap");
        exteriorSwipe.moveEnd = function(evt, dir, phase, swipetype, distance) {
            if (phase == "end") {
                if (dir == "right") {
                    var idx = exteriorNum - 1;
                    if (idx < 0) idx = exteriorMaxNum - 1;
                    $(".gallery_exterior .wide_wrap .gallery_paging > ul > li:eq(" + idx + ") > a").trigger("click");
                } else if (dir == "left") {
                    var idx = exteriorNum + 1;
                    if (idx > exteriorMaxNum - 1) idx = 0;
                    $(".gallery_exterior .wide_wrap .gallery_paging > ul > li:eq(" + idx + ") > a").trigger("click");
                }
            }
        };

        $(".gallery_exterior .wide_wrap  .gallery_paging > ul > li > a").on("click", function(e) {
            e.stopPropagation();
            e.preventDefault();
            if (!$(this).parent().hasClass("on")) {
                $(".gallery_exterior .wide_wrap .gallery_paging > ul > li").removeClass("on");
                $(this).parent().addClass("on");
                var idx = $(this).parent().index();
                $(".gallery_exterior .wide_wrap .img_wrap > div").hide();
                $(".gallery_exterior .wide_wrap .img_wrap > div").eq(idx).show();
                exteriorNum = idx;
            }
        }); 
    }

    function mobileInterior(){
        var interiorSwipe = new onSwipeFnc(".gallery_interior .wide_wrap .img_wrap");
        interiorSwipe.moveEnd = function(evt, dir, phase, swipetype, distance) {
            if (phase == "end") {
                if (dir == "right") {
                    var idx = interiorNum - 1;
                    if (idx < 0) idx = interiorMaxNum - 1;
                    $(".gallery_interior .wide_wrap .gallery_paging > ul > li:eq(" + idx + ") > a").trigger("click");
                } else if (dir == "left") {
                    var idx = interiorNum + 1;
                    if (idx > interiorMaxNum - 1) idx = 0;
                    $(".gallery_interior .wide_wrap .gallery_paging > ul > li:eq(" + idx + ") > a").trigger("click");
                }
            }
        };

        $(".gallery_interior .wide_wrap  .gallery_paging > ul > li > a").on("click", function(e) {
            e.stopPropagation();
            e.preventDefault();
            if (!$(this).parent().hasClass("on")) {
                $(".gallery_interior .wide_wrap .gallery_paging > ul > li").removeClass("on");
                $(this).parent().addClass("on");
                var idx = $(this).parent().index();
                $(".gallery_interior .wide_wrap .img_wrap > div").hide();
                $(".gallery_interior .wide_wrap .img_wrap > div").eq(idx).show();
                interiorNum = idx;
            }
        }); 
    }        
    
    function mobilevideo(){
         var videoSwipe = new onSwipeFnc(".gallery_video .wide_wrap .img_wrap");
         videoSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
             if(phase == "end"){
                  if(dir == "right"){
                      var idx = videoNum-1;
                      if(idx < 0) idx = videoMaxNum -1;
                      $(".gallery_video .wide_wrap .gallery_paging > ul > li:eq("+ idx +") > a").trigger("click");
                  }else if(dir == "left"){
                      var idx = videoNum+1;
                      if(idx > videoMaxNum -1) idx = 0;
                      $(".gallery_video .wide_wrap .gallery_paging > ul > li:eq("+ idx +") > a").trigger("click");
                  }
              }        
         };
         $(".gallery_video .wide_wrap .gallery_paging > ul > li > a").on("click", function(e) {
            e.stopPropagation();
            e.preventDefault();
            if (!$(this).parent().hasClass("on")) {
                $(".gallery_video .wide_wrap .gallery_paging > ul > li").removeClass("on");
                $(this).parent().addClass("on");
                var idx = $(this).parent().index();
                $(".gallery_video .wide_wrap .img_wrap > div").hide();
                $(".gallery_video .wide_wrap .img_wrap > div").eq(idx).show();
                videoNum = idx;
            }
        }); 
    }
};


//리뷰초기화
var reviewInit = function(){
    var expertReviewNum = 0, expertReviewMaxNum, expertReviewLiWidth, mediaReviewNum = 0, mediaReviewMaxNum ,mediaReviewLiWidth;
    var $reviewPrevBtn = $(".review_interaction a.prev"), $reviewNextBtn = $(".review_interaction a.next"), $mediaPrevBtn = $(".media_review a.prev"), $mediaNextBtn = $(".media_review a.next"); 
    $(window).resize(function() {
        if($(window).height()!=lastWindowHeight || $(window).width()!=lastWindowWidth){
            lastWindowHeight = $(window).height();
            lastWindowWidth = $(window).width();
            reviewReisze();
        }
        getBrowserHeight_vh();
    }).resize();
    
    $(window).load(function(){reviewInit();});
    
    function reviewInit(){
        expertReviewMaxNum = $(".review_interaction .control ul.num > li").length;
        mediaReviewMaxNum =  $(".media_review .control ul.num > li").length;
        $reviewPrevBtn.hide();
        $mediaPrevBtn.hide();
        if(expertReviewMaxNum < 2){
            $reviewNextBtn.hide();
        }
        if(mediaReviewMaxNum < 4){
            $mediaNextBtn.hide();
        }
        var expertReviewSwipe = new onSwipeFnc(".review_interaction .slide_wrap");
        expertReviewSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
            if(phase == "end"){
                  if(dir == "right"){
                      var idx = expertReviewNum-1;
                      if(idx < 0) idx = expertReviewMaxNum-1;
                      $(".review_interaction .control ul.num > li:eq("+ idx +") > a").trigger("click");
                  }else if(dir == "left"){
                      var idx = expertReviewNum+1;
                      if(idx > expertReviewMaxNum-1) idx = 0;
                      $(".review_interaction .control ul.num > li:eq("+ idx +") > a").trigger("click");
                  }
              }        
          };
          
        var mediaReviewSwipe = new onSwipeFnc(".media_review .mediaCon > ul");
        mediaReviewSwipe.moveEnd = function(evt, dir, phase, swipetype, distance){
            if(phase == "end"){
                  if(dir == "right"){
                      var idx = mediaReviewNum-1;
                      if(idx < 0) idx = mediaReviewMaxNum-1;
                      $(".media_review .control ul.num > li:eq("+ idx +") > a").trigger("click");
                  }else if(dir == "left"){
                      var idx = mediaReviewNum+1;
                      if(idx > mediaReviewMaxNum-1) idx = 0;
                      $(".media_review .control ul.num > li:eq("+ idx +") > a").trigger("click");
                  }
              }        
          };
    }
    
    $reviewNextBtn.on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        var idx = expertReviewNum+1;
        expertReviewPosSet(idx,0.5);
    });
    
    $reviewPrevBtn.on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        var idx = expertReviewNum-1;
        expertReviewPosSet(idx,0.5);
    });
    
    $(".review_interaction .control ul.num > li > a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        var idx = $(this).parent().index();
        expertReviewPosSet(idx,0.5);
    });

    $mediaNextBtn.on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        var idx = mediaReviewNum+1;
        mediaReviewPosSet(idx,0.5);
    });
    
    $mediaPrevBtn.on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        var idx = mediaReviewNum-1;
        mediaReviewPosSet(idx,0.5);
    });
    
    $(".media_review .control ul.num > li > a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        var idx = $(this).parent().index();
        mediaReviewPosSet(idx,0.5);
    });
        
    function expertReviewPosSet(idx,duration){
        $(".review_interaction .control ul.num > li").removeClass("on");
        $(".review_interaction .control ul.num > li").eq(idx).addClass("on");
        expertReviewLiWidth = $(".review_interaction .slide_wrap .img_wrap > li").width();
        TweenMax.to($(".review_interaction .slide_wrap .img_wrap"), duration, {marginLeft: expertReviewLiWidth *-idx,  ease:"easeOutExpo", force3D:true});
        expertReviewNum = idx;
        if(expertReviewNum == 0){
            $reviewNextBtn.show();
            $reviewPrevBtn.hide();
        }else if(expertReviewNum == expertReviewMaxNum-1){
            $reviewNextBtn.hide();
            $reviewPrevBtn.show();
        }else{
            $reviewNextBtn.show();
            $reviewPrevBtn.show();
        }
    }
    
    function mediaReviewPosSet(idx,duration){
        $(".media_review .control ul.num > li").removeClass("on");
        $(".media_review .control ul.num > li").eq(idx).addClass("on");
        mediaReviewLiWidth = $(".media_review .mediaCon > ul > li").width() + 9;
        TweenMax.to($(".media_review .mediaCon > ul"), duration, {marginLeft: mediaReviewLiWidth *-idx,  ease:"easeOutExpo", force3D:true});
        mediaReviewNum = idx;
        if(mediaReviewNum == 0){
            $mediaNextBtn.show();
            $mediaPrevBtn.hide();
        }else if(mediaReviewNum == mediaReviewMaxNum-1){
            $mediaNextBtn.hide();
            $mediaPrevBtn.show();
        }else{
            $mediaNextBtn.show();
            $mediaPrevBtn.show();
        }
    }
        
    function reviewReisze(){
        document.body.style.overflow = "hidden";
        var realViewportWidth = $(window).width();
        document.body.style.overflow = "";
        var viewportWidth = $(window).width();
       
        if(IE_VER < 9 && IE_VER !== false){ 
              $(".review .review_visual > h3, .review .review_visual > div").css({"width":"940px","margin":"0 auto"});             
              $(".review_interaction .slide_wrap ul.img_wrap > li").css("width",940);
              $(".review_interaction .slide_wrap ul.img_wrap > li .review_data").css("width",672);
              $(".review_interaction .slide_wrap ul.img_wrap").css({"margin-left":940 * -expertReviewNum});
              $(".media_review .mediaCon > ul > li").css({"width":940/3-6});
              $(".review .media_review").css("width",940);
        }else{
            if(realViewportWidth > 980){
              $(".review .review_visual > h3, .review .review_visual > div").css({"width":"940px","margin":"0 auto"});             
              $(".review_interaction .slide_wrap ul.img_wrap > li").css("width",940);
              $(".review_interaction .slide_wrap ul.img_wrap > li .review_data").css("width",672);
              $(".review_interaction .slide_wrap ul.img_wrap").css({"margin-left":940 * -expertReviewNum});
              $(".media_review .mediaCon > ul > li").css({"width":940/3-6});
              $(".review .media_review").css("width",940);
              mediaReviewLiWidth = $(".media_review .mediaCon > ul > li").width() + 9;
              $(".media_review .mediaCon > ul").css("margin-left",mediaReviewLiWidth * -mediaReviewNum);
            }else if(realViewportWidth > MOBILE_WIDTH){
                $(".review .review_visual > h3, .review .review_visual > div").css({"width": "auto","margin":""});
                $(".review_interaction .slide_wrap ul.img_wrap > li").css("width",viewportWidth-30);                
                $(".review_interaction .slide_wrap ul.img_wrap > li .review_data").css("width",viewportWidth-240-85);
                $(".review_interaction .slide_wrap ul.img_wrap").css({"margin-left":(viewportWidth-30) * -expertReviewNum});
                $(".media_review .mediaCon > ul > li").css("width",viewportWidth/3-18);
                $(".review .media_review").css("width","auto");
                mediaReviewLiWidth = $(".media_review .mediaCon > ul > li").width() + 9;
                $(".media_review .mediaCon > ul").css("margin-left",mediaReviewLiWidth * -mediaReviewNum);
            }else{
                $(".review .review_visual > h3, .review .review_visual > div").css({"width": "auto","margin":""});
                $(".review_interaction .slide_wrap ul.img_wrap > li").css("width",viewportWidth-30);
                $(".review_interaction .slide_wrap ul.img_wrap > li .review_data").css("width",viewportWidth-68);
                $(".review_interaction .slide_wrap ul.img_wrap").css({"margin-left":(viewportWidth-30) * -expertReviewNum});
                $(".media_review .mediaCon > ul > li").css("width",viewportWidth-30);
                $(".review .media_review").css("width","auto");
                mediaReviewLiWidth = viewportWidth-20;
                $(".media_review .mediaCon > ul").css("margin-left",mediaReviewLiWidth * -mediaReviewNum);
            }    
        }
    }
};

var environmentInit = function(){
    var environPop = new OpenDimPop($("#pop_environment"));
    $(".certificate .imgArea > a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        var popTitle = $(this).find("span.title").text();
        var popImg = $(this).find("span.thum_img img").attr("src");
        $("#pop_environment .pop_tit").text(popTitle);
        $("#pop_environment .pop_con img").attr("src", popImg);
        environPop.open();
    });
};

var tabContentsInit = function(){
    $("ul.tab_type2 > li > a.tab_a").on("click", function(e){
        e.stopPropagation();
        e.preventDefault();
        $("ul.tab_type2 > li > a.tab_a").removeClass("tab_on");
        $(this).addClass("tab_on");
        var idx = $(this).parent().index();
        $(".tab_contents_area").css("display","none");
        $(".tab_contents_area").eq(idx).css("display","block");
    });
};

function getURLParameter(url, name) {
    return (RegExp(name + '=' + '(.+?)(&|$)').exec(url)||[,null])[1];
};

/* S : 180808 */
var mobileScrollPos = function(){
    $("body").append("<div class='mScrollPos'><span class='gr'><span class='txt'>0%</span></span></div>")
    var scrollPercent = 0;
    $(window).scroll(function(){
        scrollPercent = Math.round( ($(window).scrollTop()/ ($(document).height()-$(window).height())) * 100 );
        $(".mScrollPos span.gr").css({"width":scrollPercent + "%"});
        $(".mScrollPos span.txt").text(scrollPercent + "%");
        if(scrollPercent <= 10){
           $(".mScrollPos span.txt").addClass("first");
        }else if(scrollPercent >= 93){
          $(".mScrollPos span.txt").addClass("last");
        }else{
          $(".mScrollPos span.txt").removeClass("first last")
        }
    });
    
};


/* S : 180919v3 */
var snb_titAction = function(){
    $(".snb_tit a").addClass("act").children(".lg_img").addClass("bgNo");
    // css keyframes tiem 2.2s
    var chSrc = $(".snb_tit a img").attr("data-src");
    if(chSrc != undefined){
        setTimeout(function(){
            $(".snb_tit a").removeClass("act");
            $(".snb_tit a img").attr("src", chSrc);
        }, 2200);
    }
}
/* S : 180919v3 */
/* E : 180808 */
